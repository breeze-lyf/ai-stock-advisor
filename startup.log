ðŸš€ Starting AI Smart Investment Advisor...
ðŸ“ˆ Starting Backend (FastAPI) on port 8000...
ðŸ’» Starting Frontend (Next.js) on port 3000...
INFO:     Will watch for changes in these directories: ['/Users/breeze/Dev/ai-stock-advisor/backend']
INFO:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [65340] using StatReload
âœ… Services are running!
   - Frontend: http://localhost:3000
   - Backend:  http://localhost:8000/docs
Press CTRL+C to stop.

> frontend@0.1.0 dev
> next dev

2026-02-09 15:53:57,975 - app.api.v1.endpoints.portfolio - INFO - PHASE: Portfolio router module importing...
â–² Next.js 16.1.2 (Turbopack)
- Local:         http://localhost:3000
- Network:       http://10.10.10.247:3000

âœ“ Starting...
INFO:     Started server process [65343]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
âœ“ Ready in 448ms
 GET /register 200 in 450ms (compile: 341ms, render: 109ms)
 GET /login 200 in 356ms (compile: 324ms, render: 32ms)
2026-02-09 15:54:00,171 - api_logger - INFO - rid=/api/health method=HEAD status_code=404 user_id=anonymous time=0.54ms
INFO:     127.0.0.1:58047 - "HEAD /api/health HTTP/1.1" 404 Not Found
 HEAD / 200 in 77ms (compile: 13ms, render: 64ms)
 GET /sw.js 404 in 71ms (compile: 46ms, render: 25ms)
2026-02-09 15:54:14,558 - api_logger - INFO - rid=/health method=GET status_code=200 user_id=anonymous time=0.51ms
INFO:     127.0.0.1:58074 - "GET /health HTTP/1.1" 200 OK
2026-02-09 15:54:14,590 - api_logger - INFO - rid=/ method=GET status_code=200 user_id=anonymous time=0.30ms
INFO:     127.0.0.1:58075 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:58109 - "OPTIONS /api/auth/register HTTP/1.1" 200 OK
2026-02-09 15:54:26,336 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 15:54:26,336 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 15:54:26,348 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.email = ?
2026-02-09 15:54:26,348 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.email = ?
2026-02-09 15:54:26,348 INFO sqlalchemy.engine.Engine [generated in 0.00023s] ('test_new_final@example.com',)
2026-02-09 15:54:26,348 - sqlalchemy.engine.Engine - INFO - [generated in 0.00023s] ('test_new_final@example.com',)
2026-02-09 15:54:26,629 INFO sqlalchemy.engine.Engine INSERT INTO users (id, email, hashed_password, is_active, membership_tier, api_key_gemini, api_key_deepseek, api_key_siliconflow, preferred_data_source, preferred_ai_model, created_at, last_login) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2026-02-09 15:54:26,629 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (id, email, hashed_password, is_active, membership_tier, api_key_gemini, api_key_deepseek, api_key_siliconflow, preferred_data_source, preferred_ai_model, created_at, last_login) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2026-02-09 15:54:26,630 INFO sqlalchemy.engine.Engine [generated in 0.00060s] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3', 'test_new_final@example.com', '$2b$12$Ai3lDuIb7AwgQ0spJ.bZY.xVMVazjrQmy77yBw3NL4DoDa3qmd1mS', 1, 'FREE', None, None, None, 'ALPHA_VANTAGE', 'gemini-1.5-flash', '2026-02-09 07:54:26.629852', None)
2026-02-09 15:54:26,630 - sqlalchemy.engine.Engine - INFO - [generated in 0.00060s] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3', 'test_new_final@example.com', '$2b$12$Ai3lDuIb7AwgQ0spJ.bZY.xVMVazjrQmy77yBw3NL4DoDa3qmd1mS', 1, 'FREE', None, None, None, 'ALPHA_VANTAGE', 'gemini-1.5-flash', '2026-02-09 07:54:26.629852', None)
2026-02-09 15:54:26,632 INFO sqlalchemy.engine.Engine COMMIT
2026-02-09 15:54:26,632 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-09 15:54:26,633 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 15:54:26,633 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 15:54:26,634 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:54:26,634 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:54:26,634 INFO sqlalchemy.engine.Engine [generated in 0.00007s] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 15:54:26,634 - sqlalchemy.engine.Engine - INFO - [generated in 0.00007s] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 15:54:26,641 - api_logger - INFO - rid=/api/auth/register method=POST status_code=200 user_id=anonymous time=356.31ms
INFO:     127.0.0.1:58109 - "POST /api/auth/register HTTP/1.1" 200 OK
2026-02-09 15:54:26,643 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 15:54:26,643 - sqlalchemy.engine.Engine - INFO - ROLLBACK
 GET / 200 in 23ms (compile: 4ms, render: 19ms)
INFO:     127.0.0.1:58109 - "OPTIONS /api/portfolio/?refresh=false HTTP/1.1" 200 OK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710066, 'sub': '27f9c1a8-f876-4722-ac36-4f9fc0835ec3'}
2026-02-09 15:54:26,783 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 15:54:26,783 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 15:54:26,786 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:54:26,786 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:54:26,786 INFO sqlalchemy.engine.Engine [generated in 0.00078s] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 15:54:26,786 - sqlalchemy.engine.Engine - INFO - [generated in 0.00078s] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 15:54:26,789 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 15:54:26,789 - sqlalchemy.engine.Engine - INFO - SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 15:54:26,789 INFO sqlalchemy.engine.Engine [generated in 0.00015s] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 15:54:26,789 - sqlalchemy.engine.Engine - INFO - [generated in 0.00015s] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 15:54:26,791 - api_logger - INFO - rid=/api/portfolio/ method=GET status_code=200 user_id=27f9c1a8-f876-4722-ac36-4f9fc0835ec3 time=15.07ms
INFO:     127.0.0.1:58109 - "GET /api/portfolio/?refresh=false HTTP/1.1" 200 OK
2026-02-09 15:54:26,792 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 15:54:26,792 - sqlalchemy.engine.Engine - INFO - ROLLBACK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710066, 'sub': '27f9c1a8-f876-4722-ac36-4f9fc0835ec3'}
2026-02-09 15:54:26,793 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 15:54:26,793 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 15:54:26,793 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:54:26,793 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:54:26,793 INFO sqlalchemy.engine.Engine [cached since 0.008225s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 15:54:26,793 - sqlalchemy.engine.Engine - INFO - [cached since 0.008225s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 15:54:26,794 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 15:54:26,794 - sqlalchemy.engine.Engine - INFO - SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 15:54:26,794 INFO sqlalchemy.engine.Engine [cached since 0.004632s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 15:54:26,794 - sqlalchemy.engine.Engine - INFO - [cached since 0.004632s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 15:54:26,794 - api_logger - INFO - rid=/api/portfolio/ method=GET status_code=200 user_id=27f9c1a8-f876-4722-ac36-4f9fc0835ec3 time=2.05ms
INFO:     127.0.0.1:58109 - "GET /api/portfolio/?refresh=false HTTP/1.1" 200 OK
2026-02-09 15:54:26,795 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 15:54:26,795 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 15:56:36,583 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 15:56:36,583 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 15:56:36,584 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.email = ?
2026-02-09 15:56:36,584 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.email = ?
2026-02-09 15:56:36,584 INFO sqlalchemy.engine.Engine [cached since 130.2s ago] ('test@qq.com',)
2026-02-09 15:56:36,584 - sqlalchemy.engine.Engine - INFO - [cached since 130.2s ago] ('test@qq.com',)
2026-02-09 15:56:36,789 - api_logger - INFO - rid=/api/auth/login method=POST status_code=200 user_id=anonymous time=214.37ms
INFO:     127.0.0.1:58327 - "POST /api/auth/login HTTP/1.1" 200 OK
2026-02-09 15:56:36,790 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 15:56:36,790 - sqlalchemy.engine.Engine - INFO - ROLLBACK
 GET / 200 in 13ms (compile: 4ms, render: 9ms)
INFO:     127.0.0.1:58327 - "OPTIONS /api/portfolio/?refresh=false HTTP/1.1" 200 OK
INFO:     127.0.0.1:58334 - "OPTIONS /api/portfolio/?refresh=false HTTP/1.1" 200 OK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 15:56:36,899 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 15:56:36,899 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 15:56:36,899 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:56:36,899 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:56:36,899 INFO sqlalchemy.engine.Engine [cached since 130.1s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 15:56:36,899 - sqlalchemy.engine.Engine - INFO - [cached since 130.1s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 15:56:36,901 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 15:56:36,901 - sqlalchemy.engine.Engine - INFO - SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 15:56:36,901 INFO sqlalchemy.engine.Engine [cached since 130.1s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 15:56:36,901 - sqlalchemy.engine.Engine - INFO - [cached since 130.1s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 15:56:36,905 - api_logger - INFO - rid=/api/portfolio/ method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=7.63ms
INFO:     127.0.0.1:58334 - "GET /api/portfolio/?refresh=false HTTP/1.1" 200 OK
2026-02-09 15:56:36,906 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 15:56:36,906 - sqlalchemy.engine.Engine - INFO - ROLLBACK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 15:56:36,911 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 15:56:36,911 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 15:56:36,911 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:56:36,911 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:56:36,911 INFO sqlalchemy.engine.Engine [cached since 130.1s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 15:56:36,911 - sqlalchemy.engine.Engine - INFO - [cached since 130.1s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 15:56:36,912 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 15:56:36,912 - sqlalchemy.engine.Engine - INFO - SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 15:56:36,913 INFO sqlalchemy.engine.Engine [cached since 130.1s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 15:56:36,913 - sqlalchemy.engine.Engine - INFO - [cached since 130.1s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 15:56:36,916 - api_logger - INFO - rid=/api/portfolio/ method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=7.79ms
INFO:     127.0.0.1:58327 - "GET /api/portfolio/?refresh=false HTTP/1.1" 200 OK
2026-02-09 15:56:36,917 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 15:56:36,917 - sqlalchemy.engine.Engine - INFO - ROLLBACK
 GET /?ticker=002050 200 in 13ms (compile: 3ms, render: 9ms)
INFO:     127.0.0.1:58327 - "OPTIONS /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
INFO:     127.0.0.1:58334 - "OPTIONS /api/analysis/002050 HTTP/1.1" 200 OK
INFO:     127.0.0.1:58335 - "OPTIONS /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
INFO:     127.0.0.1:58336 - "OPTIONS /api/portfolio/002050/news HTTP/1.1" 200 OK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 15:56:36,964 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 15:56:36,964 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 15:56:36,966 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:56:36,966 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:56:36,966 INFO sqlalchemy.engine.Engine [cached since 130.2s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 15:56:36,966 - sqlalchemy.engine.Engine - INFO - [cached since 130.2s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 15:56:36,968 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 15:56:36,968 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 15:56:36,969 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:56:36,969 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:56:36,969 INFO sqlalchemy.engine.Engine [cached since 130.2s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 15:56:36,969 - sqlalchemy.engine.Engine - INFO - [cached since 130.2s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
 GET /?ticker=002050 200 in 14ms (compile: 5ms, render: 9ms)
2026-02-09 15:56:36,974 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 15:56:36,974 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 15:56:36,974 INFO sqlalchemy.engine.Engine [generated in 0.00073s] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 15:56:36,974 - sqlalchemy.engine.Engine - INFO - [generated in 0.00073s] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 15:56:36,976 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 15:56:36,976 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 15:56:36,976 INFO sqlalchemy.engine.Engine [generated in 0.00014s] ('002050', 20, 0)
2026-02-09 15:56:36,976 - sqlalchemy.engine.Engine - INFO - [generated in 0.00014s] ('002050', 20, 0)
2026-02-09 15:56:36,977 - api_logger - INFO - rid=/api/analysis/002050 method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=16.84ms
INFO:     127.0.0.1:58327 - "GET /api/analysis/002050 HTTP/1.1" 200 OK
2026-02-09 15:56:36,978 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 15:56:36,978 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 15:56:36,979 - api_logger - INFO - rid=/api/portfolio/002050/news method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=12.30ms
INFO:     127.0.0.1:58336 - "GET /api/portfolio/002050/news HTTP/1.1" 200 OK
2026-02-09 15:56:36,980 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 15:56:36,980 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 15:56:37,575 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=614.90ms
INFO:     127.0.0.1:58334 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
2026-02-09 15:56:37,877 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=297.52ms
INFO:     127.0.0.1:58336 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
 GET /?ticker=002970 200 in 17ms (compile: 5ms, render: 13ms)
INFO:     127.0.0.1:58336 - "OPTIONS /api/stocks/002970/history?period=1y HTTP/1.1" 200 OK
INFO:     127.0.0.1:58334 - "OPTIONS /api/analysis/002970 HTTP/1.1" 200 OK
INFO:     127.0.0.1:58327 - "OPTIONS /api/stocks/002970/history?period=1y HTTP/1.1" 200 OK
INFO:     127.0.0.1:58335 - "OPTIONS /api/portfolio/002970/news HTTP/1.1" 200 OK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 15:56:38,796 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 15:56:38,796 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 15:56:38,796 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:56:38,796 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:56:38,797 INFO sqlalchemy.engine.Engine [cached since 132s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 15:56:38,797 - sqlalchemy.engine.Engine - INFO - [cached since 132s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 15:56:38,797 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 15:56:38,797 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 15:56:38,797 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:56:38,797 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:56:38,797 INFO sqlalchemy.engine.Engine [cached since 132s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 15:56:38,797 - sqlalchemy.engine.Engine - INFO - [cached since 132s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 15:56:38,800 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 15:56:38,800 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 15:56:38,800 INFO sqlalchemy.engine.Engine [cached since 1.826s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002970', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 15:56:38,800 - sqlalchemy.engine.Engine - INFO - [cached since 1.826s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002970', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 15:56:38,800 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 15:56:38,800 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 15:56:38,801 INFO sqlalchemy.engine.Engine [cached since 1.825s ago] ('002970', 20, 0)
2026-02-09 15:56:38,801 - sqlalchemy.engine.Engine - INFO - [cached since 1.825s ago] ('002970', 20, 0)
2026-02-09 15:56:38,803 - api_logger - INFO - rid=/api/portfolio/002970/news method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=5.85ms
INFO:     127.0.0.1:58335 - "GET /api/portfolio/002970/news HTTP/1.1" 200 OK
2026-02-09 15:56:38,804 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 15:56:38,804 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 15:56:38,805 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 15:56:38,805 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 15:56:38,805 - api_logger - INFO - rid=/api/analysis/002970 method=GET status_code=404 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=10.07ms
INFO:     127.0.0.1:58327 - "GET /api/analysis/002970 HTTP/1.1" 404 Not Found
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 15:56:38,859 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 15:56:38,859 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 15:56:38,861 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:56:38,861 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:56:38,861 INFO sqlalchemy.engine.Engine [cached since 132.1s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 15:56:38,861 - sqlalchemy.engine.Engine - INFO - [cached since 132.1s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 15:56:38,862 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 15:56:38,862 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 15:56:38,862 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:56:38,862 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:56:38,862 INFO sqlalchemy.engine.Engine [cached since 132.1s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 15:56:38,862 - sqlalchemy.engine.Engine - INFO - [cached since 132.1s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 15:56:38,863 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 15:56:38,863 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 15:56:38,863 INFO sqlalchemy.engine.Engine [cached since 1.887s ago] ('002050', 20, 0)
2026-02-09 15:56:38,863 - sqlalchemy.engine.Engine - INFO - [cached since 1.887s ago] ('002050', 20, 0)
2026-02-09 15:56:38,863 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 15:56:38,863 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 15:56:38,863 INFO sqlalchemy.engine.Engine [cached since 1.889s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 15:56:38,863 - sqlalchemy.engine.Engine - INFO - [cached since 1.889s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 15:56:38,864 - api_logger - INFO - rid=/api/analysis/002050 method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=9.03ms
INFO:     127.0.0.1:58335 - "GET /api/analysis/002050 HTTP/1.1" 200 OK
2026-02-09 15:56:38,865 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 15:56:38,865 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 15:56:38,865 - api_logger - INFO - rid=/api/portfolio/002050/news method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=10.00ms
INFO:     127.0.0.1:58336 - "GET /api/portfolio/002050/news HTTP/1.1" 200 OK
2026-02-09 15:56:38,866 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 15:56:38,866 - sqlalchemy.engine.Engine - INFO - ROLLBACK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 15:56:38,915 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 15:56:38,915 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 15:56:38,915 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:56:38,915 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:56:38,915 INFO sqlalchemy.engine.Engine [cached since 132.1s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 15:56:38,915 - sqlalchemy.engine.Engine - INFO - [cached since 132.1s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 15:56:38,916 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 15:56:38,916 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 15:56:38,916 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:56:38,916 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:56:38,916 INFO sqlalchemy.engine.Engine [cached since 132.1s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 15:56:38,916 - sqlalchemy.engine.Engine - INFO - [cached since 132.1s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 15:56:38,917 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 15:56:38,917 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 15:56:38,918 INFO sqlalchemy.engine.Engine [cached since 1.944s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002970', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 15:56:38,918 - sqlalchemy.engine.Engine - INFO - [cached since 1.944s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002970', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 15:56:38,918 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 15:56:38,918 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 15:56:38,919 INFO sqlalchemy.engine.Engine [cached since 1.943s ago] ('002970', 20, 0)
2026-02-09 15:56:38,919 - sqlalchemy.engine.Engine - INFO - [cached since 1.943s ago] ('002970', 20, 0)
2026-02-09 15:56:38,920 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 15:56:38,920 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 15:56:38,921 - api_logger - INFO - rid=/api/portfolio/002970/news method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=5.49ms
INFO:     127.0.0.1:58335 - "GET /api/portfolio/002970/news HTTP/1.1" 200 OK
2026-02-09 15:56:38,921 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 15:56:38,921 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 15:56:38,921 - api_logger - INFO - rid=/api/analysis/002970 method=GET status_code=404 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=7.20ms
INFO:     127.0.0.1:58336 - "GET /api/analysis/002970 HTTP/1.1" 404 Not Found
2026-02-09 15:56:39,144 - api_logger - INFO - rid=/api/stocks/002970/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=351.04ms
INFO:     127.0.0.1:58334 - "GET /api/stocks/002970/history?period=1y HTTP/1.1" 200 OK
2026-02-09 15:56:39,168 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=313.92ms
INFO:     127.0.0.1:58327 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
2026-02-09 15:56:39,436 - api_logger - INFO - rid=/api/stocks/002970/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=283.01ms
INFO:     127.0.0.1:58384 - "GET /api/stocks/002970/history?period=1y HTTP/1.1" 200 OK
2026-02-09 15:56:39,448 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=279.90ms
INFO:     127.0.0.1:58334 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
2026-02-09 15:56:39,680 - api_logger - INFO - rid=/api/stocks/002970/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=240.15ms
INFO:     127.0.0.1:58327 - "GET /api/stocks/002970/history?period=1y HTTP/1.1" 200 OK
2026-02-09 15:56:39,920 - api_logger - INFO - rid=/api/stocks/002970/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=238.33ms
INFO:     127.0.0.1:58334 - "GET /api/stocks/002970/history?period=1y HTTP/1.1" 200 OK
 GET /?ticker=002050 200 in 15ms (compile: 4ms, render: 11ms)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 15:56:40,431 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 15:56:40,431 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 15:56:40,432 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:56:40,432 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:56:40,432 INFO sqlalchemy.engine.Engine [cached since 133.6s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 15:56:40,432 - sqlalchemy.engine.Engine - INFO - [cached since 133.6s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 15:56:40,433 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 15:56:40,433 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 15:56:40,434 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:56:40,434 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:56:40,435 INFO sqlalchemy.engine.Engine [cached since 133.6s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 15:56:40,435 - sqlalchemy.engine.Engine - INFO - [cached since 133.6s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 15:56:40,437 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 15:56:40,437 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 15:56:40,437 INFO sqlalchemy.engine.Engine [cached since 3.461s ago] ('002050', 20, 0)
2026-02-09 15:56:40,437 - sqlalchemy.engine.Engine - INFO - [cached since 3.461s ago] ('002050', 20, 0)
2026-02-09 15:56:40,437 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 15:56:40,437 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 15:56:40,437 INFO sqlalchemy.engine.Engine [cached since 3.463s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 15:56:40,437 - sqlalchemy.engine.Engine - INFO - [cached since 3.463s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 15:56:40,439 - api_logger - INFO - rid=/api/analysis/002050 method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=9.06ms
INFO:     127.0.0.1:58327 - "GET /api/analysis/002050 HTTP/1.1" 200 OK
2026-02-09 15:56:40,440 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 15:56:40,440 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 15:56:40,441 - api_logger - INFO - rid=/api/portfolio/002050/news method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=11.22ms
INFO:     127.0.0.1:58384 - "GET /api/portfolio/002050/news HTTP/1.1" 200 OK
2026-02-09 15:56:40,442 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 15:56:40,442 - sqlalchemy.engine.Engine - INFO - ROLLBACK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 15:56:40,498 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 15:56:40,498 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 15:56:40,498 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:56:40,498 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:56:40,499 INFO sqlalchemy.engine.Engine [cached since 133.7s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 15:56:40,499 - sqlalchemy.engine.Engine - INFO - [cached since 133.7s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 15:56:40,500 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 15:56:40,500 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 15:56:40,501 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:56:40,501 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:56:40,501 INFO sqlalchemy.engine.Engine [cached since 133.7s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 15:56:40,501 - sqlalchemy.engine.Engine - INFO - [cached since 133.7s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 15:56:40,503 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 15:56:40,503 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 15:56:40,504 INFO sqlalchemy.engine.Engine [cached since 3.53s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002970', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 15:56:40,504 - sqlalchemy.engine.Engine - INFO - [cached since 3.53s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002970', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 15:56:40,505 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 15:56:40,505 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 15:56:40,505 INFO sqlalchemy.engine.Engine [cached since 3.529s ago] ('002970', 20, 0)
2026-02-09 15:56:40,505 - sqlalchemy.engine.Engine - INFO - [cached since 3.529s ago] ('002970', 20, 0)
2026-02-09 15:56:40,506 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 15:56:40,506 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 15:56:40,509 - api_logger - INFO - rid=/api/analysis/002970 method=GET status_code=404 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=11.12ms
INFO:     127.0.0.1:58327 - "GET /api/analysis/002970 HTTP/1.1" 404 Not Found
2026-02-09 15:56:40,509 - api_logger - INFO - rid=/api/portfolio/002970/news method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=10.07ms
INFO:     127.0.0.1:58439 - "GET /api/portfolio/002970/news HTTP/1.1" 200 OK
2026-02-09 15:56:40,510 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 15:56:40,510 - sqlalchemy.engine.Engine - INFO - ROLLBACK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 15:56:40,547 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 15:56:40,547 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 15:56:40,547 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:56:40,547 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:56:40,547 INFO sqlalchemy.engine.Engine [cached since 133.8s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 15:56:40,547 - sqlalchemy.engine.Engine - INFO - [cached since 133.8s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 15:56:40,551 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 15:56:40,551 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 15:56:40,551 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:56:40,551 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 15:56:40,552 INFO sqlalchemy.engine.Engine [cached since 133.8s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 15:56:40,552 - sqlalchemy.engine.Engine - INFO - [cached since 133.8s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 15:56:40,553 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 15:56:40,553 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 15:56:40,553 INFO sqlalchemy.engine.Engine [cached since 3.58s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 15:56:40,553 - sqlalchemy.engine.Engine - INFO - [cached since 3.58s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 15:56:40,556 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 15:56:40,556 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 15:56:40,556 INFO sqlalchemy.engine.Engine [cached since 3.58s ago] ('002050', 20, 0)
2026-02-09 15:56:40,556 - sqlalchemy.engine.Engine - INFO - [cached since 3.58s ago] ('002050', 20, 0)
2026-02-09 15:56:40,558 - api_logger - INFO - rid=/api/analysis/002050 method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=12.63ms
INFO:     127.0.0.1:58439 - "GET /api/analysis/002050 HTTP/1.1" 200 OK
2026-02-09 15:56:40,559 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 15:56:40,559 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 15:56:40,560 - api_logger - INFO - rid=/api/portfolio/002050/news method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=11.66ms
INFO:     127.0.0.1:58327 - "GET /api/portfolio/002050/news HTTP/1.1" 200 OK
2026-02-09 15:56:40,560 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 15:56:40,560 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 15:56:40,704 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=275.27ms
INFO:     127.0.0.1:58334 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
2026-02-09 15:56:40,730 - api_logger - INFO - rid=/api/stocks/002970/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=232.65ms
INFO:     127.0.0.1:58384 - "GET /api/stocks/002970/history?period=1y HTTP/1.1" 200 OK
2026-02-09 15:56:41,001 - api_logger - INFO - rid=/api/stocks/002970/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=269.38ms
INFO:     127.0.0.1:58334 - "GET /api/stocks/002970/history?period=1y HTTP/1.1" 200 OK
2026-02-09 15:56:41,012 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=307.61ms
INFO:     127.0.0.1:58327 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
2026-02-09 15:56:41,266 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=252.28ms
INFO:     127.0.0.1:58334 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
2026-02-09 15:56:41,688 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=421.32ms
INFO:     127.0.0.1:58327 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
âœ“ Compiled in 542ms
INFO:     127.0.0.1:59005 - "OPTIONS /api/stocks/AAPL/history?period=1y HTTP/1.1" 200 OK
INFO:     127.0.0.1:59006 - "OPTIONS /api/analysis/AAPL HTTP/1.1" 200 OK
INFO:     127.0.0.1:59007 - "OPTIONS /api/stocks/AAPL/history?period=1y HTTP/1.1" 200 OK
INFO:     127.0.0.1:59008 - "OPTIONS /api/portfolio/AAPL/news HTTP/1.1" 200 OK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:01:46,965 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:01:46,965 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:01:46,968 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:01:46,968 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:01:46,969 INFO sqlalchemy.engine.Engine [cached since 440.2s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:01:46,969 - sqlalchemy.engine.Engine - INFO - [cached since 440.2s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:01:46,970 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:01:46,970 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:01:46,971 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:01:46,971 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:01:46,971 INFO sqlalchemy.engine.Engine [cached since 440.2s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:01:46,971 - sqlalchemy.engine.Engine - INFO - [cached since 440.2s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:01:46,978 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:01:46,978 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:01:46,979 INFO sqlalchemy.engine.Engine [cached since 310s ago] ('AAPL', 20, 0)
2026-02-09 16:01:46,979 - sqlalchemy.engine.Engine - INFO - [cached since 310s ago] ('AAPL', 20, 0)
2026-02-09 16:01:46,982 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:01:46,982 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:01:46,985 INFO sqlalchemy.engine.Engine [cached since 310s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', 'AAPL', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 16:01:46,985 - sqlalchemy.engine.Engine - INFO - [cached since 310s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', 'AAPL', 'qwen-3-vl-thinking', 1, 0)
 GET /?ticker=AAPL 200 in 107ms (compile: 68ms, render: 39ms)
2026-02-09 16:01:47,001 - api_logger - INFO - rid=/api/analysis/AAPL method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=40.76ms
INFO:     127.0.0.1:59006 - "GET /api/analysis/AAPL HTTP/1.1" 200 OK
2026-02-09 16:01:47,003 - api_logger - INFO - rid=/api/portfolio/AAPL/news method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=42.74ms
INFO:     127.0.0.1:59008 - "GET /api/portfolio/AAPL/news HTTP/1.1" 200 OK
2026-02-09 16:01:47,004 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:01:47,004 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:01:47,008 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:01:47,008 - sqlalchemy.engine.Engine - INFO - ROLLBACK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:01:47,013 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:01:47,013 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:01:47,028 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:01:47,028 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:01:47,028 INFO sqlalchemy.engine.Engine [cached since 440.2s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:01:47,028 - sqlalchemy.engine.Engine - INFO - [cached since 440.2s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:01:47,042 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:01:47,042 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:01:47,043 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:01:47,043 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:01:47,043 INFO sqlalchemy.engine.Engine [cached since 440.3s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:01:47,043 - sqlalchemy.engine.Engine - INFO - [cached since 440.3s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:01:47,045 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:01:47,045 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:01:47,045 INFO sqlalchemy.engine.Engine [cached since 310.1s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 16:01:47,045 - sqlalchemy.engine.Engine - INFO - [cached since 310.1s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 16:01:47,047 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:01:47,047 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:01:47,047 INFO sqlalchemy.engine.Engine [cached since 310.1s ago] ('002050', 20, 0)
2026-02-09 16:01:47,047 - sqlalchemy.engine.Engine - INFO - [cached since 310.1s ago] ('002050', 20, 0)
2026-02-09 16:01:47,048 - api_logger - INFO - rid=/api/analysis/002050 method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=35.86ms
INFO:     127.0.0.1:59006 - "GET /api/analysis/002050 HTTP/1.1" 200 OK
2026-02-09 16:01:47,049 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:01:47,049 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:01:47,051 - api_logger - INFO - rid=/api/portfolio/002050/news method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=38.91ms
INFO:     127.0.0.1:59005 - "GET /api/portfolio/002050/news HTTP/1.1" 200 OK
2026-02-09 16:01:47,052 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:01:47,052 - sqlalchemy.engine.Engine - INFO - ROLLBACK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:01:47,113 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:01:47,113 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:01:47,113 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:01:47,113 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:01:47,113 INFO sqlalchemy.engine.Engine [cached since 440.3s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:01:47,113 - sqlalchemy.engine.Engine - INFO - [cached since 440.3s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:01:47,114 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:01:47,114 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:01:47,114 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:01:47,114 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:01:47,114 INFO sqlalchemy.engine.Engine [cached since 440.3s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:01:47,114 - sqlalchemy.engine.Engine - INFO - [cached since 440.3s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:01:47,115 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:01:47,115 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:01:47,115 INFO sqlalchemy.engine.Engine [cached since 310.1s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', 'AAPL', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 16:01:47,115 - sqlalchemy.engine.Engine - INFO - [cached since 310.1s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', 'AAPL', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 16:01:47,116 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:01:47,116 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:01:47,116 INFO sqlalchemy.engine.Engine [cached since 310.1s ago] ('AAPL', 20, 0)
2026-02-09 16:01:47,116 - sqlalchemy.engine.Engine - INFO - [cached since 310.1s ago] ('AAPL', 20, 0)
2026-02-09 16:01:47,118 - api_logger - INFO - rid=/api/analysis/AAPL method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=6.30ms
INFO:     127.0.0.1:59005 - "GET /api/analysis/AAPL HTTP/1.1" 200 OK
2026-02-09 16:01:47,134 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:01:47,134 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:01:47,134 - api_logger - INFO - rid=/api/portfolio/AAPL/news method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=21.42ms
INFO:     127.0.0.1:59006 - "GET /api/portfolio/AAPL/news HTTP/1.1" 200 OK
2026-02-09 16:01:47,135 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:01:47,135 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:01:47,594 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=583.34ms
INFO:     127.0.0.1:59008 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
2026-02-09 16:01:47,949 - api_logger - INFO - rid=/api/stocks/AAPL/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=998.93ms
INFO:     127.0.0.1:59007 - "GET /api/stocks/AAPL/history?period=1y HTTP/1.1" 200 OK
2026-02-09 16:01:48,028 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=432.77ms
INFO:     127.0.0.1:59006 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
2026-02-09 16:01:48,072 - api_logger - INFO - rid=/api/stocks/AAPL/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=121.70ms
INFO:     127.0.0.1:59008 - "GET /api/stocks/AAPL/history?period=1y HTTP/1.1" 200 OK
2026-02-09 16:01:48,457 - api_logger - INFO - rid=/api/stocks/AAPL/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=384.64ms
INFO:     127.0.0.1:59006 - "GET /api/stocks/AAPL/history?period=1y HTTP/1.1" 200 OK
2026-02-09 16:01:48,851 - api_logger - INFO - rid=/api/stocks/AAPL/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=391.47ms
INFO:     127.0.0.1:59008 - "GET /api/stocks/AAPL/history?period=1y HTTP/1.1" 200 OK
 GET /?ticker=002050 200 in 19ms (compile: 3ms, render: 15ms)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:01:52,149 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:01:52,149 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:01:52,150 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:01:52,150 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:01:52,150 INFO sqlalchemy.engine.Engine [cached since 445.4s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:01:52,150 - sqlalchemy.engine.Engine - INFO - [cached since 445.4s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:01:52,151 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:01:52,151 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:01:52,153 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:01:52,153 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:01:52,153 INFO sqlalchemy.engine.Engine [cached since 445.4s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:01:52,153 - sqlalchemy.engine.Engine - INFO - [cached since 445.4s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:01:52,158 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:01:52,158 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:01:52,158 INFO sqlalchemy.engine.Engine [cached since 315.2s ago] ('002050', 20, 0)
2026-02-09 16:01:52,158 - sqlalchemy.engine.Engine - INFO - [cached since 315.2s ago] ('002050', 20, 0)
2026-02-09 16:01:52,158 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:01:52,158 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:01:52,158 INFO sqlalchemy.engine.Engine [cached since 315.2s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 16:01:52,158 - sqlalchemy.engine.Engine - INFO - [cached since 315.2s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 16:01:52,159 - api_logger - INFO - rid=/api/analysis/002050 method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=10.54ms
INFO:     127.0.0.1:59079 - "GET /api/analysis/002050 HTTP/1.1" 200 OK
2026-02-09 16:01:52,161 - api_logger - INFO - rid=/api/portfolio/002050/news method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=12.84ms
INFO:     127.0.0.1:59080 - "GET /api/portfolio/002050/news HTTP/1.1" 200 OK
2026-02-09 16:01:52,162 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:01:52,162 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:01:52,163 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:01:52,163 - sqlalchemy.engine.Engine - INFO - ROLLBACK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:01:52,216 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:01:52,216 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:01:52,218 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:01:52,218 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:01:52,218 INFO sqlalchemy.engine.Engine [cached since 445.4s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:01:52,218 - sqlalchemy.engine.Engine - INFO - [cached since 445.4s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:01:52,222 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:01:52,222 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:01:52,223 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:01:52,223 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:01:52,223 INFO sqlalchemy.engine.Engine [cached since 445.4s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:01:52,223 - sqlalchemy.engine.Engine - INFO - [cached since 445.4s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:01:52,224 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:01:52,224 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:01:52,224 INFO sqlalchemy.engine.Engine [cached since 315.3s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', 'AAPL', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 16:01:52,224 - sqlalchemy.engine.Engine - INFO - [cached since 315.3s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', 'AAPL', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 16:01:52,224 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:01:52,224 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:01:52,224 INFO sqlalchemy.engine.Engine [cached since 315.2s ago] ('AAPL', 20, 0)
2026-02-09 16:01:52,224 - sqlalchemy.engine.Engine - INFO - [cached since 315.2s ago] ('AAPL', 20, 0)
2026-02-09 16:01:52,225 - api_logger - INFO - rid=/api/analysis/AAPL method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=10.80ms
INFO:     127.0.0.1:59079 - "GET /api/analysis/AAPL HTTP/1.1" 200 OK
2026-02-09 16:01:52,225 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:01:52,225 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:01:52,226 - api_logger - INFO - rid=/api/portfolio/AAPL/news method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=6.08ms
INFO:     127.0.0.1:59085 - "GET /api/portfolio/AAPL/news HTTP/1.1" 200 OK
2026-02-09 16:01:52,226 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:01:52,226 - sqlalchemy.engine.Engine - INFO - ROLLBACK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:01:52,277 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:01:52,277 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:01:52,283 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:01:52,283 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:01:52,284 INFO sqlalchemy.engine.Engine [cached since 445.5s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:01:52,284 - sqlalchemy.engine.Engine - INFO - [cached since 445.5s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:01:52,285 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:01:52,285 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:01:52,286 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:01:52,286 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:01:52,286 INFO sqlalchemy.engine.Engine [cached since 445.5s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:01:52,286 - sqlalchemy.engine.Engine - INFO - [cached since 445.5s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:01:52,287 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:01:52,287 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:01:52,287 INFO sqlalchemy.engine.Engine [cached since 315.3s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 16:01:52,287 - sqlalchemy.engine.Engine - INFO - [cached since 315.3s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 16:01:52,289 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:01:52,289 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:01:52,289 INFO sqlalchemy.engine.Engine [cached since 315.3s ago] ('002050', 20, 0)
2026-02-09 16:01:52,289 - sqlalchemy.engine.Engine - INFO - [cached since 315.3s ago] ('002050', 20, 0)
2026-02-09 16:01:52,291 - api_logger - INFO - rid=/api/analysis/002050 method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=16.41ms
INFO:     127.0.0.1:59085 - "GET /api/analysis/002050 HTTP/1.1" 200 OK
2026-02-09 16:01:52,292 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:01:52,292 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:01:52,294 - api_logger - INFO - rid=/api/portfolio/002050/news method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=10.03ms
INFO:     127.0.0.1:59079 - "GET /api/portfolio/002050/news HTTP/1.1" 200 OK
2026-02-09 16:01:52,295 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:01:52,295 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:01:52,332 - api_logger - INFO - rid=/api/stocks/AAPL/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=118.65ms
INFO:     127.0.0.1:59080 - "GET /api/stocks/AAPL/history?period=1y HTTP/1.1" 200 OK
2026-02-09 16:01:52,447 - api_logger - INFO - rid=/api/stocks/AAPL/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=113.91ms
INFO:     127.0.0.1:59079 - "GET /api/stocks/AAPL/history?period=1y HTTP/1.1" 200 OK
2026-02-09 16:01:52,538 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=389.09ms
INFO:     127.0.0.1:59078 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
2026-02-09 16:01:52,931 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=391.43ms
INFO:     127.0.0.1:59079 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
2026-02-09 16:01:53,333 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=400.21ms
INFO:     127.0.0.1:59078 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
2026-02-09 16:01:53,738 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=404.08ms
INFO:     127.0.0.1:59079 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
âœ“ Compiled in 221ms
âœ“ Compiled in 26ms
âœ“ Compiled in 89ms
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:05:21,235 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:05:21,235 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:05:21,239 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:05:21,239 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:05:21,239 INFO sqlalchemy.engine.Engine [cached since 654.5s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:05:21,239 - sqlalchemy.engine.Engine - INFO - [cached since 654.5s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:05:21,240 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:05:21,240 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:05:21,240 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:05:21,240 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:05:21,240 INFO sqlalchemy.engine.Engine [cached since 654.5s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:05:21,240 - sqlalchemy.engine.Engine - INFO - [cached since 654.5s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:05:21,241 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:05:21,241 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:05:21,241 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:05:21,241 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:05:21,241 INFO sqlalchemy.engine.Engine [cached since 654.5s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:05:21,241 - sqlalchemy.engine.Engine - INFO - [cached since 654.5s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:05:21,243 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 16:05:21,243 - sqlalchemy.engine.Engine - INFO - SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 16:05:21,243 INFO sqlalchemy.engine.Engine [cached since 654.5s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:05:21,243 - sqlalchemy.engine.Engine - INFO - [cached since 654.5s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:05:21,244 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:05:21,244 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:05:21,244 INFO sqlalchemy.engine.Engine [cached since 524.3s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 16:05:21,244 - sqlalchemy.engine.Engine - INFO - [cached since 524.3s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 16:05:21,244 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:05:21,244 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:05:21,244 INFO sqlalchemy.engine.Engine [cached since 524.3s ago] ('002050', 20, 0)
2026-02-09 16:05:21,244 - sqlalchemy.engine.Engine - INFO - [cached since 524.3s ago] ('002050', 20, 0)
2026-02-09 16:05:21,246 - api_logger - INFO - rid=/api/portfolio/ method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=21.06ms
INFO:     127.0.0.1:59439 - "GET /api/portfolio/?refresh=false HTTP/1.1" 200 OK
2026-02-09 16:05:21,247 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:05:21,247 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:05:21,247 - api_logger - INFO - rid=/api/portfolio/002050/news method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=22.43ms
INFO:     127.0.0.1:59440 - "GET /api/portfolio/002050/news HTTP/1.1" 200 OK
2026-02-09 16:05:21,248 - api_logger - INFO - rid=/api/analysis/002050 method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=23.38ms
INFO:     127.0.0.1:59438 - "GET /api/analysis/002050 HTTP/1.1" 200 OK
2026-02-09 16:05:21,248 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:05:21,248 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:05:21,248 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:05:21,248 - sqlalchemy.engine.Engine - INFO - ROLLBACK
âš  Fast Refresh had to perform a full reload due to a runtime error.
 GET /?ticker=002050 200 in 162ms (compile: 36ms, render: 126ms)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:05:21,497 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:05:21,497 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:05:21,497 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:05:21,497 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:05:21,497 INFO sqlalchemy.engine.Engine [cached since 654.7s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:05:21,497 - sqlalchemy.engine.Engine - INFO - [cached since 654.7s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:05:21,498 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:05:21,498 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:05:21,498 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:05:21,498 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:05:21,498 INFO sqlalchemy.engine.Engine [cached since 654.7s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:05:21,498 - sqlalchemy.engine.Engine - INFO - [cached since 654.7s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:05:21,499 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:05:21,499 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:05:21,499 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:05:21,499 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:05:21,499 INFO sqlalchemy.engine.Engine [cached since 654.7s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:05:21,499 - sqlalchemy.engine.Engine - INFO - [cached since 654.7s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:05:21,500 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:05:21,500 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:05:21,500 INFO sqlalchemy.engine.Engine [cached since 524.5s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 16:05:21,500 - sqlalchemy.engine.Engine - INFO - [cached since 524.5s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 16:05:21,500 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 16:05:21,500 - sqlalchemy.engine.Engine - INFO - SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 16:05:21,500 INFO sqlalchemy.engine.Engine [cached since 654.7s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:05:21,500 - sqlalchemy.engine.Engine - INFO - [cached since 654.7s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:05:21,500 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:05:21,500 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:05:21,500 INFO sqlalchemy.engine.Engine [cached since 524.5s ago] ('002050', 20, 0)
2026-02-09 16:05:21,500 - sqlalchemy.engine.Engine - INFO - [cached since 524.5s ago] ('002050', 20, 0)
2026-02-09 16:05:21,501 - api_logger - INFO - rid=/api/analysis/002050 method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=5.20ms
INFO:     127.0.0.1:59440 - "GET /api/analysis/002050 HTTP/1.1" 200 OK
2026-02-09 16:05:21,502 - api_logger - INFO - rid=/api/portfolio/002050/news method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=2.93ms
INFO:     127.0.0.1:59456 - "GET /api/portfolio/002050/news HTTP/1.1" 200 OK
2026-02-09 16:05:21,502 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:05:21,502 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:05:21,503 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:05:21,503 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:05:21,505 - api_logger - INFO - rid=/api/portfolio/ method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=6.97ms
INFO:     127.0.0.1:59439 - "GET /api/portfolio/?refresh=false HTTP/1.1" 200 OK
2026-02-09 16:05:21,505 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:05:21,505 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:05:21,873 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=586.55ms
2026-02-09 16:05:22,015 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=434.18ms
INFO:     127.0.0.1:59439 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
âœ“ Compiled in 47ms
 GET / 200 in 195ms (compile: 87ms, render: 108ms)
INFO:     127.0.0.1:59547 - "OPTIONS /api/portfolio/?refresh=false HTTP/1.1" 200 OK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710066, 'sub': '27f9c1a8-f876-4722-ac36-4f9fc0835ec3'}
2026-02-09 16:05:40,655 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:05:40,655 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:05:40,655 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:05:40,655 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:05:40,655 INFO sqlalchemy.engine.Engine [cached since 673.9s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 16:05:40,655 - sqlalchemy.engine.Engine - INFO - [cached since 673.9s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 16:05:40,655 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 16:05:40,655 - sqlalchemy.engine.Engine - INFO - SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 16:05:40,656 INFO sqlalchemy.engine.Engine [cached since 673.9s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 16:05:40,656 - sqlalchemy.engine.Engine - INFO - [cached since 673.9s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 16:05:40,656 - api_logger - INFO - rid=/api/portfolio/ method=GET status_code=200 user_id=27f9c1a8-f876-4722-ac36-4f9fc0835ec3 time=2.49ms
INFO:     127.0.0.1:59547 - "GET /api/portfolio/?refresh=false HTTP/1.1" 200 OK
2026-02-09 16:05:40,657 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:05:40,657 - sqlalchemy.engine.Engine - INFO - ROLLBACK
 GET /sw.js 404 in 34ms (compile: 14ms, render: 20ms)
INFO:     127.0.0.1:59664 - "OPTIONS /api/portfolio/search?query=0&remote=false HTTP/1.1" 200 OK
2026-02-09 16:05:53,393 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:05:53,393 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:05:53,395 INFO sqlalchemy.engine.Engine SELECT stocks.ticker, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM stocks 
WHERE lower(stocks.ticker) LIKE lower(?) OR lower(stocks.name) LIKE lower(?)
 LIMIT ? OFFSET ?
2026-02-09 16:05:53,395 - sqlalchemy.engine.Engine - INFO - SELECT stocks.ticker, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM stocks 
WHERE lower(stocks.ticker) LIKE lower(?) OR lower(stocks.name) LIKE lower(?)
 LIMIT ? OFFSET ?
2026-02-09 16:05:53,395 INFO sqlalchemy.engine.Engine [generated in 0.00042s] ('%0%', '%0%', 10, 0)
2026-02-09 16:05:53,395 - sqlalchemy.engine.Engine - INFO - [generated in 0.00042s] ('%0%', '%0%', 10, 0)
INFO:     127.0.0.1:59665 - "OPTIONS /api/portfolio/search?query=00&remote=false HTTP/1.1" 200 OK
INFO:     127.0.0.1:59666 - "OPTIONS /api/portfolio/search?query=002&remote=false HTTP/1.1" 200 OK
2026-02-09 16:05:53,399 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:05:53,399 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:05:53,399 INFO sqlalchemy.engine.Engine SELECT stocks.ticker, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM stocks 
WHERE lower(stocks.ticker) LIKE lower(?) OR lower(stocks.name) LIKE lower(?)
 LIMIT ? OFFSET ?
2026-02-09 16:05:53,399 - sqlalchemy.engine.Engine - INFO - SELECT stocks.ticker, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM stocks 
WHERE lower(stocks.ticker) LIKE lower(?) OR lower(stocks.name) LIKE lower(?)
 LIMIT ? OFFSET ?
2026-02-09 16:05:53,399 INFO sqlalchemy.engine.Engine [cached since 0.004371s ago] ('%00%', '%00%', 10, 0)
2026-02-09 16:05:53,399 - sqlalchemy.engine.Engine - INFO - [cached since 0.004371s ago] ('%00%', '%00%', 10, 0)
2026-02-09 16:05:53,400 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:05:53,400 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:05:53,400 INFO sqlalchemy.engine.Engine SELECT stocks.ticker, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM stocks 
WHERE lower(stocks.ticker) LIKE lower(?) OR lower(stocks.name) LIKE lower(?)
 LIMIT ? OFFSET ?
2026-02-09 16:05:53,400 - sqlalchemy.engine.Engine - INFO - SELECT stocks.ticker, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM stocks 
WHERE lower(stocks.ticker) LIKE lower(?) OR lower(stocks.name) LIKE lower(?)
 LIMIT ? OFFSET ?
2026-02-09 16:05:53,400 INFO sqlalchemy.engine.Engine [cached since 0.005423s ago] ('%002%', '%002%', 10, 0)
2026-02-09 16:05:53,400 - sqlalchemy.engine.Engine - INFO - [cached since 0.005423s ago] ('%002%', '%002%', 10, 0)
2026-02-09 16:05:53,401 - api_logger - INFO - rid=/api/portfolio/search method=GET status_code=200 user_id=27f9c1a8-f876-4722-ac36-4f9fc0835ec3 time=12.34ms
INFO:     127.0.0.1:59664 - "GET /api/portfolio/search?query=0&remote=false HTTP/1.1" 200 OK
2026-02-09 16:05:53,401 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:05:53,401 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:05:53,402 - api_logger - INFO - rid=/api/portfolio/search method=GET status_code=200 user_id=27f9c1a8-f876-4722-ac36-4f9fc0835ec3 time=3.74ms
INFO:     127.0.0.1:59665 - "GET /api/portfolio/search?query=00&remote=false HTTP/1.1" 200 OK
2026-02-09 16:05:53,402 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:05:53,402 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:05:53,403 - api_logger - INFO - rid=/api/portfolio/search method=GET status_code=200 user_id=27f9c1a8-f876-4722-ac36-4f9fc0835ec3 time=3.34ms
INFO:     127.0.0.1:59666 - "GET /api/portfolio/search?query=002&remote=false HTTP/1.1" 200 OK
2026-02-09 16:05:53,404 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:05:53,404 - sqlalchemy.engine.Engine - INFO - ROLLBACK
INFO:     127.0.0.1:59666 - "OPTIONS /api/portfolio/search?query=0020&remote=false HTTP/1.1" 200 OK
2026-02-09 16:05:53,407 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:05:53,407 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:05:53,407 INFO sqlalchemy.engine.Engine SELECT stocks.ticker, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM stocks 
WHERE lower(stocks.ticker) LIKE lower(?) OR lower(stocks.name) LIKE lower(?)
 LIMIT ? OFFSET ?
2026-02-09 16:05:53,407 - sqlalchemy.engine.Engine - INFO - SELECT stocks.ticker, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM stocks 
WHERE lower(stocks.ticker) LIKE lower(?) OR lower(stocks.name) LIKE lower(?)
 LIMIT ? OFFSET ?
2026-02-09 16:05:53,407 INFO sqlalchemy.engine.Engine [cached since 0.01292s ago] ('%0020%', '%0020%', 10, 0)
2026-02-09 16:05:53,407 - sqlalchemy.engine.Engine - INFO - [cached since 0.01292s ago] ('%0020%', '%0020%', 10, 0)
2026-02-09 16:05:53,408 - api_logger - INFO - rid=/api/portfolio/search method=GET status_code=200 user_id=27f9c1a8-f876-4722-ac36-4f9fc0835ec3 time=1.48ms
INFO:     127.0.0.1:59666 - "GET /api/portfolio/search?query=0020&remote=false HTTP/1.1" 200 OK
2026-02-09 16:05:53,408 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:05:53,408 - sqlalchemy.engine.Engine - INFO - ROLLBACK
INFO:     127.0.0.1:59666 - "OPTIONS /api/portfolio/search?query=00205&remote=false HTTP/1.1" 200 OK
2026-02-09 16:05:53,412 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:05:53,412 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:05:53,412 INFO sqlalchemy.engine.Engine SELECT stocks.ticker, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM stocks 
WHERE lower(stocks.ticker) LIKE lower(?) OR lower(stocks.name) LIKE lower(?)
 LIMIT ? OFFSET ?
2026-02-09 16:05:53,412 - sqlalchemy.engine.Engine - INFO - SELECT stocks.ticker, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM stocks 
WHERE lower(stocks.ticker) LIKE lower(?) OR lower(stocks.name) LIKE lower(?)
 LIMIT ? OFFSET ?
2026-02-09 16:05:53,413 INFO sqlalchemy.engine.Engine [cached since 0.01801s ago] ('%00205%', '%00205%', 10, 0)
2026-02-09 16:05:53,413 - sqlalchemy.engine.Engine - INFO - [cached since 0.01801s ago] ('%00205%', '%00205%', 10, 0)
2026-02-09 16:05:53,414 - api_logger - INFO - rid=/api/portfolio/search method=GET status_code=200 user_id=27f9c1a8-f876-4722-ac36-4f9fc0835ec3 time=2.05ms
INFO:     127.0.0.1:59666 - "GET /api/portfolio/search?query=00205&remote=false HTTP/1.1" 200 OK
2026-02-09 16:05:53,414 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:05:53,414 - sqlalchemy.engine.Engine - INFO - ROLLBACK
INFO:     127.0.0.1:59666 - "OPTIONS /api/portfolio/search?query=002050&remote=false HTTP/1.1" 200 OK
2026-02-09 16:05:53,419 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:05:53,419 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:05:53,419 INFO sqlalchemy.engine.Engine SELECT stocks.ticker, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM stocks 
WHERE lower(stocks.ticker) LIKE lower(?) OR lower(stocks.name) LIKE lower(?)
 LIMIT ? OFFSET ?
2026-02-09 16:05:53,419 - sqlalchemy.engine.Engine - INFO - SELECT stocks.ticker, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM stocks 
WHERE lower(stocks.ticker) LIKE lower(?) OR lower(stocks.name) LIKE lower(?)
 LIMIT ? OFFSET ?
2026-02-09 16:05:53,419 INFO sqlalchemy.engine.Engine [cached since 0.02491s ago] ('%002050%', '%002050%', 10, 0)
2026-02-09 16:05:53,419 - sqlalchemy.engine.Engine - INFO - [cached since 0.02491s ago] ('%002050%', '%002050%', 10, 0)
2026-02-09 16:05:53,421 - api_logger - INFO - rid=/api/portfolio/search method=GET status_code=200 user_id=27f9c1a8-f876-4722-ac36-4f9fc0835ec3 time=3.13ms
INFO:     127.0.0.1:59666 - "GET /api/portfolio/search?query=002050&remote=false HTTP/1.1" 200 OK
2026-02-09 16:05:53,423 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:05:53,423 - sqlalchemy.engine.Engine - INFO - ROLLBACK
INFO:     127.0.0.1:59684 - "OPTIONS /api/portfolio/ HTTP/1.1" 200 OK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710066, 'sub': '27f9c1a8-f876-4722-ac36-4f9fc0835ec3'}
2026-02-09 16:06:00,238 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:06:00,238 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:06:00,239 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:06:00,239 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:06:00,239 INFO sqlalchemy.engine.Engine [cached since 693.5s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 16:06:00,239 - sqlalchemy.engine.Engine - INFO - [cached since 693.5s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 16:06:00,242 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at 
FROM portfolios 
WHERE portfolios.user_id = ? AND portfolios.ticker = ?
2026-02-09 16:06:00,242 - sqlalchemy.engine.Engine - INFO - SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at 
FROM portfolios 
WHERE portfolios.user_id = ? AND portfolios.ticker = ?
2026-02-09 16:06:00,242 INFO sqlalchemy.engine.Engine [generated in 0.00031s] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3', '002050')
2026-02-09 16:06:00,242 - sqlalchemy.engine.Engine - INFO - [generated in 0.00031s] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3', '002050')
2026-02-09 16:06:00,246 INFO sqlalchemy.engine.Engine INSERT INTO portfolios (id, user_id, ticker, quantity, avg_cost, target_price, stop_loss_price, created_at, updated_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)
2026-02-09 16:06:00,246 - sqlalchemy.engine.Engine - INFO - INSERT INTO portfolios (id, user_id, ticker, quantity, avg_cost, target_price, stop_loss_price, created_at, updated_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)
2026-02-09 16:06:00,246 INFO sqlalchemy.engine.Engine [generated in 0.00070s] ('4e7579ef-6e4b-4ba3-b10b-4c8c87ba48d1', '27f9c1a8-f876-4722-ac36-4f9fc0835ec3', '002050', 0.0, 0.0, None, None, '2026-02-09 08:06:00.246455', '2026-02-09 08:06:00.246466')
2026-02-09 16:06:00,246 - sqlalchemy.engine.Engine - INFO - [generated in 0.00070s] ('4e7579ef-6e4b-4ba3-b10b-4c8c87ba48d1', '27f9c1a8-f876-4722-ac36-4f9fc0835ec3', '002050', 0.0, 0.0, None, None, '2026-02-09 08:06:00.246455', '2026-02-09 08:06:00.246466')
2026-02-09 16:06:00,248 INFO sqlalchemy.engine.Engine COMMIT
2026-02-09 16:06:00,248 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-09 16:06:00,249 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:06:00,249 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:06:00,250 INFO sqlalchemy.engine.Engine SELECT market_data_cache.ticker, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated 
FROM market_data_cache 
WHERE market_data_cache.ticker = ?
2026-02-09 16:06:00,250 - sqlalchemy.engine.Engine - INFO - SELECT market_data_cache.ticker, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated 
FROM market_data_cache 
WHERE market_data_cache.ticker = ?
2026-02-09 16:06:00,251 INFO sqlalchemy.engine.Engine [generated in 0.00020s] ('002050',)
2026-02-09 16:06:00,251 - sqlalchemy.engine.Engine - INFO - [generated in 0.00020s] ('002050',)
2026-02-09 16:06:00,252 - api_logger - INFO - rid=/api/portfolio/ method=POST status_code=200 user_id=27f9c1a8-f876-4722-ac36-4f9fc0835ec3 time=17.22ms
INFO:     127.0.0.1:59684 - "POST /api/portfolio/ HTTP/1.1" 200 OK
2026-02-09 16:06:00,253 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:06:00,253 - sqlalchemy.engine.Engine - INFO - ROLLBACK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710066, 'sub': '27f9c1a8-f876-4722-ac36-4f9fc0835ec3'}
2026-02-09 16:06:00,256 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:06:00,256 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:06:00,256 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:06:00,256 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:06:00,256 INFO sqlalchemy.engine.Engine [cached since 693.5s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 16:06:00,256 - sqlalchemy.engine.Engine - INFO - [cached since 693.5s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 16:06:00,257 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 16:06:00,257 - sqlalchemy.engine.Engine - INFO - SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 16:06:00,257 INFO sqlalchemy.engine.Engine [cached since 693.5s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 16:06:00,257 - sqlalchemy.engine.Engine - INFO - [cached since 693.5s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 16:06:00,257 - api_logger - INFO - rid=/api/portfolio/ method=GET status_code=200 user_id=27f9c1a8-f876-4722-ac36-4f9fc0835ec3 time=2.27ms
INFO:     127.0.0.1:59684 - "GET /api/portfolio/?refresh=false HTTP/1.1" 200 OK
2026-02-09 16:06:00,257 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:06:00,257 - sqlalchemy.engine.Engine - INFO - ROLLBACK
 GET /?ticker=002050 200 in 14ms (compile: 4ms, render: 10ms)
INFO:     127.0.0.1:59684 - "OPTIONS /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
INFO:     127.0.0.1:59686 - "OPTIONS /api/analysis/002050 HTTP/1.1" 200 OK
INFO:     127.0.0.1:59687 - "OPTIONS /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
INFO:     127.0.0.1:59688 - "OPTIONS /api/portfolio/002050/news HTTP/1.1" 200 OK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710066, 'sub': '27f9c1a8-f876-4722-ac36-4f9fc0835ec3'}
2026-02-09 16:06:00,336 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:06:00,336 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:06:00,349 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:06:00,349 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:06:00,349 INFO sqlalchemy.engine.Engine [cached since 693.6s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 16:06:00,349 - sqlalchemy.engine.Engine - INFO - [cached since 693.6s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710066, 'sub': '27f9c1a8-f876-4722-ac36-4f9fc0835ec3'}
2026-02-09 16:06:00,356 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:06:00,356 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:06:00,356 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:06:00,356 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:06:00,356 INFO sqlalchemy.engine.Engine [cached since 693.6s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 16:06:00,356 - sqlalchemy.engine.Engine - INFO - [cached since 693.6s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 16:06:00,359 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:06:00,359 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:06:00,360 INFO sqlalchemy.engine.Engine [cached since 563.4s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3', '002050', 'gemini-1.5-flash', 1, 0)
2026-02-09 16:06:00,360 - sqlalchemy.engine.Engine - INFO - [cached since 563.4s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3', '002050', 'gemini-1.5-flash', 1, 0)
2026-02-09 16:06:00,366 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:06:00,366 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:06:00,366 INFO sqlalchemy.engine.Engine [cached since 563.4s ago] ('002050', 20, 0)
2026-02-09 16:06:00,366 - sqlalchemy.engine.Engine - INFO - [cached since 563.4s ago] ('002050', 20, 0)
2026-02-09 16:06:00,373 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:06:00,373 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:06:00,380 - api_logger - INFO - rid=/api/portfolio/002050/news method=GET status_code=200 user_id=27f9c1a8-f876-4722-ac36-4f9fc0835ec3 time=25.53ms
INFO:     127.0.0.1:59688 - "GET /api/portfolio/002050/news HTTP/1.1" 200 OK
2026-02-09 16:06:00,382 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:06:00,382 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:06:00,382 - api_logger - INFO - rid=/api/analysis/002050 method=GET status_code=404 user_id=27f9c1a8-f876-4722-ac36-4f9fc0835ec3 time=48.39ms
INFO:     127.0.0.1:59686 - "GET /api/analysis/002050 HTTP/1.1" 404 Not Found
2026-02-09 16:06:00,837 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=27f9c1a8-f876-4722-ac36-4f9fc0835ec3 time=511.63ms
INFO:     127.0.0.1:59684 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
2026-02-09 16:06:01,091 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=27f9c1a8-f876-4722-ac36-4f9fc0835ec3 time=251.94ms
INFO:     127.0.0.1:59684 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
 GET /?ticker=002050 200 in 45ms (compile: 11ms, render: 34ms)
INFO:     127.0.0.1:59953 - "OPTIONS /api/analysis/002050 HTTP/1.1" 200 OK
INFO:     127.0.0.1:59954 - "OPTIONS /api/portfolio/?refresh=false HTTP/1.1" 200 OK
INFO:     127.0.0.1:59955 - "OPTIONS /api/portfolio/002050/news HTTP/1.1" 200 OK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:08:06,148 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:08:06,148 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:08:06,149 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:08:06,149 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:08:06,149 INFO sqlalchemy.engine.Engine [cached since 819.4s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:08:06,149 - sqlalchemy.engine.Engine - INFO - [cached since 819.4s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:08:06,150 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:08:06,150 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:08:06,151 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:08:06,151 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:08:06,151 INFO sqlalchemy.engine.Engine [cached since 819.4s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:08:06,151 - sqlalchemy.engine.Engine - INFO - [cached since 819.4s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:08:06,151 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:08:06,151 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:08:06,151 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:08:06,151 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:08:06,151 INFO sqlalchemy.engine.Engine [cached since 819.4s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:08:06,151 - sqlalchemy.engine.Engine - INFO - [cached since 819.4s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:08:06,157 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:08:06,157 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:08:06,157 INFO sqlalchemy.engine.Engine [cached since 689.2s ago] ('002050', 20, 0)
2026-02-09 16:08:06,157 - sqlalchemy.engine.Engine - INFO - [cached since 689.2s ago] ('002050', 20, 0)
2026-02-09 16:08:06,157 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:08:06,157 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:08:06,158 INFO sqlalchemy.engine.Engine [cached since 689.2s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 16:08:06,158 - sqlalchemy.engine.Engine - INFO - [cached since 689.2s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 16:08:06,158 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 16:08:06,158 - sqlalchemy.engine.Engine - INFO - SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 16:08:06,158 INFO sqlalchemy.engine.Engine [cached since 819.4s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:08:06,158 - sqlalchemy.engine.Engine - INFO - [cached since 819.4s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:08:06,159 - api_logger - INFO - rid=/api/analysis/002050 method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=15.41ms
INFO:     127.0.0.1:59955 - "GET /api/analysis/002050 HTTP/1.1" 200 OK
2026-02-09 16:08:06,160 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:08:06,160 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:08:06,161 - api_logger - INFO - rid=/api/portfolio/002050/news method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=15.33ms
INFO:     127.0.0.1:59953 - "GET /api/portfolio/002050/news HTTP/1.1" 200 OK
2026-02-09 16:08:06,163 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:08:06,163 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:08:06,163 - api_logger - INFO - rid=/api/portfolio/ method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=17.55ms
INFO:     127.0.0.1:59954 - "GET /api/portfolio/?refresh=false HTTP/1.1" 200 OK
2026-02-09 16:08:06,163 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:08:06,163 - sqlalchemy.engine.Engine - INFO - ROLLBACK
INFO:     127.0.0.1:59954 - "OPTIONS /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
2026-02-09 16:08:06,579 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=364.54ms
INFO:     127.0.0.1:59954 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
 GET /?ticker=002050 200 in 52ms (compile: 11ms, render: 41ms)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:08:57,741 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:08:57,741 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:08:57,741 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:08:57,741 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:08:57,741 INFO sqlalchemy.engine.Engine [cached since 871s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:08:57,741 - sqlalchemy.engine.Engine - INFO - [cached since 871s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:08:57,743 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:08:57,743 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:08:57,743 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:08:57,743 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:08:57,743 INFO sqlalchemy.engine.Engine [cached since 871s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:08:57,743 - sqlalchemy.engine.Engine - INFO - [cached since 871s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:08:57,743 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:08:57,743 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:08:57,743 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:08:57,743 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:08:57,743 INFO sqlalchemy.engine.Engine [cached since 871s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:08:57,743 - sqlalchemy.engine.Engine - INFO - [cached since 871s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:08:57,745 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:08:57,745 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:08:57,746 INFO sqlalchemy.engine.Engine [cached since 740.8s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 16:08:57,746 - sqlalchemy.engine.Engine - INFO - [cached since 740.8s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 16:08:57,748 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 16:08:57,748 - sqlalchemy.engine.Engine - INFO - SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 16:08:57,749 INFO sqlalchemy.engine.Engine [cached since 871s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:08:57,749 - sqlalchemy.engine.Engine - INFO - [cached since 871s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:08:57,749 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:08:57,749 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:08:57,749 INFO sqlalchemy.engine.Engine [cached since 740.8s ago] ('002050', 20, 0)
2026-02-09 16:08:57,749 - sqlalchemy.engine.Engine - INFO - [cached since 740.8s ago] ('002050', 20, 0)
2026-02-09 16:08:57,750 - api_logger - INFO - rid=/api/analysis/002050 method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=10.54ms
INFO:     127.0.0.1:60191 - "GET /api/analysis/002050 HTTP/1.1" 200 OK
2026-02-09 16:08:57,751 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:08:57,751 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:08:57,752 - api_logger - INFO - rid=/api/portfolio/002050/news method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=9.66ms
INFO:     127.0.0.1:60193 - "GET /api/portfolio/002050/news HTTP/1.1" 200 OK
2026-02-09 16:08:57,754 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:08:57,754 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:08:57,755 - api_logger - INFO - rid=/api/portfolio/ method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=12.21ms
INFO:     127.0.0.1:60192 - "GET /api/portfolio/?refresh=false HTTP/1.1" 200 OK
2026-02-09 16:08:57,755 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:08:57,755 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:08:58,160 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=356.74ms
INFO:     127.0.0.1:60192 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
 GET /?ticker=002050 200 in 40ms (compile: 5ms, render: 35ms)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:08:59,342 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:08:59,342 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:08:59,343 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:08:59,343 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:08:59,343 INFO sqlalchemy.engine.Engine [cached since 872.6s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:08:59,343 - sqlalchemy.engine.Engine - INFO - [cached since 872.6s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:08:59,343 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:08:59,343 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:08:59,343 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:08:59,343 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:08:59,343 INFO sqlalchemy.engine.Engine [cached since 872.6s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:08:59,343 - sqlalchemy.engine.Engine - INFO - [cached since 872.6s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:08:59,343 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:08:59,343 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:08:59,343 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:08:59,343 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:08:59,344 INFO sqlalchemy.engine.Engine [cached since 872.6s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:08:59,344 - sqlalchemy.engine.Engine - INFO - [cached since 872.6s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:08:59,344 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:08:59,344 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:08:59,344 INFO sqlalchemy.engine.Engine [cached since 742.4s ago] ('002050', 20, 0)
2026-02-09 16:08:59,344 - sqlalchemy.engine.Engine - INFO - [cached since 742.4s ago] ('002050', 20, 0)
2026-02-09 16:08:59,344 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:08:59,344 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:08:59,345 INFO sqlalchemy.engine.Engine [cached since 742.4s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 16:08:59,345 - sqlalchemy.engine.Engine - INFO - [cached since 742.4s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 16:08:59,345 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 16:08:59,345 - sqlalchemy.engine.Engine - INFO - SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 16:08:59,345 INFO sqlalchemy.engine.Engine [cached since 872.6s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:08:59,345 - sqlalchemy.engine.Engine - INFO - [cached since 872.6s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:08:59,347 - api_logger - INFO - rid=/api/analysis/002050 method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=5.41ms
INFO:     127.0.0.1:60214 - "GET /api/analysis/002050 HTTP/1.1" 200 OK
2026-02-09 16:08:59,348 - api_logger - INFO - rid=/api/portfolio/002050/news method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=4.80ms
INFO:     127.0.0.1:60216 - "GET /api/portfolio/002050/news HTTP/1.1" 200 OK
2026-02-09 16:08:59,348 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:08:59,348 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:08:59,348 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:08:59,348 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:08:59,354 - api_logger - INFO - rid=/api/portfolio/ method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=10.80ms
INFO:     127.0.0.1:60215 - "GET /api/portfolio/?refresh=false HTTP/1.1" 200 OK
2026-02-09 16:08:59,355 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:08:59,355 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:08:59,862 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=460.35ms
INFO:     127.0.0.1:60215 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
 GET /?ticker=002050 200 in 24ms (compile: 1786Âµs, render: 23ms)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:09:00,561 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:09:00,561 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:09:00,561 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:09:00,561 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:09:00,562 INFO sqlalchemy.engine.Engine [cached since 873.8s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:09:00,562 - sqlalchemy.engine.Engine - INFO - [cached since 873.8s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:09:00,563 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:09:00,563 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:09:00,563 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:09:00,563 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:09:00,563 INFO sqlalchemy.engine.Engine [cached since 873.8s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:09:00,563 - sqlalchemy.engine.Engine - INFO - [cached since 873.8s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:09:00,564 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:09:00,564 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:09:00,564 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:09:00,564 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:09:00,564 INFO sqlalchemy.engine.Engine [cached since 873.8s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:09:00,564 - sqlalchemy.engine.Engine - INFO - [cached since 873.8s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:09:00,565 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:09:00,565 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:09:00,565 INFO sqlalchemy.engine.Engine [cached since 743.6s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 16:09:00,565 - sqlalchemy.engine.Engine - INFO - [cached since 743.6s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 16:09:00,565 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 16:09:00,565 - sqlalchemy.engine.Engine - INFO - SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 16:09:00,565 INFO sqlalchemy.engine.Engine [cached since 873.8s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:09:00,565 - sqlalchemy.engine.Engine - INFO - [cached since 873.8s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:09:00,565 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:09:00,565 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:09:00,565 INFO sqlalchemy.engine.Engine [cached since 743.6s ago] ('002050', 20, 0)
2026-02-09 16:09:00,565 - sqlalchemy.engine.Engine - INFO - [cached since 743.6s ago] ('002050', 20, 0)
2026-02-09 16:09:00,566 - api_logger - INFO - rid=/api/analysis/002050 method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=5.51ms
INFO:     127.0.0.1:60215 - "GET /api/analysis/002050 HTTP/1.1" 200 OK
2026-02-09 16:09:00,566 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:09:00,566 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:09:00,567 - api_logger - INFO - rid=/api/portfolio/002050/news method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=4.64ms
INFO:     127.0.0.1:60214 - "GET /api/portfolio/002050/news HTTP/1.1" 200 OK
2026-02-09 16:09:00,568 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:09:00,568 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:09:00,570 - api_logger - INFO - rid=/api/portfolio/ method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=8.43ms
INFO:     127.0.0.1:60216 - "GET /api/portfolio/?refresh=false HTTP/1.1" 200 OK
2026-02-09 16:09:00,571 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:09:00,571 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:09:00,879 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=262.10ms
INFO:     127.0.0.1:60216 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
 GET /?ticker=002050 200 in 43ms (compile: 5ms, render: 38ms)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:09:01,540 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:09:01,540 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:09:01,540 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:09:01,540 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:09:01,540 INFO sqlalchemy.engine.Engine [cached since 874.8s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:09:01,540 - sqlalchemy.engine.Engine - INFO - [cached since 874.8s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:09:01,541 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:09:01,541 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:09:01,541 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:09:01,541 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:09:01,541 INFO sqlalchemy.engine.Engine [cached since 874.8s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:09:01,541 - sqlalchemy.engine.Engine - INFO - [cached since 874.8s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:09:01,541 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:09:01,541 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:09:01,542 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:09:01,542 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:09:01,542 INFO sqlalchemy.engine.Engine [cached since 874.8s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:09:01,542 - sqlalchemy.engine.Engine - INFO - [cached since 874.8s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:09:01,543 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:09:01,543 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:09:01,543 INFO sqlalchemy.engine.Engine [cached since 744.6s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 16:09:01,543 - sqlalchemy.engine.Engine - INFO - [cached since 744.6s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 16:09:01,548 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 16:09:01,548 - sqlalchemy.engine.Engine - INFO - SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 16:09:01,548 INFO sqlalchemy.engine.Engine [cached since 874.8s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:09:01,548 - sqlalchemy.engine.Engine - INFO - [cached since 874.8s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:09:01,550 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:09:01,550 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:09:01,550 INFO sqlalchemy.engine.Engine [cached since 744.6s ago] ('002050', 20, 0)
2026-02-09 16:09:01,550 - sqlalchemy.engine.Engine - INFO - [cached since 744.6s ago] ('002050', 20, 0)
2026-02-09 16:09:01,551 - api_logger - INFO - rid=/api/analysis/002050 method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=11.77ms
INFO:     127.0.0.1:60216 - "GET /api/analysis/002050 HTTP/1.1" 200 OK
2026-02-09 16:09:01,555 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:09:01,555 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:09:01,555 - api_logger - INFO - rid=/api/portfolio/ method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=14.50ms
INFO:     127.0.0.1:60214 - "GET /api/portfolio/?refresh=false HTTP/1.1" 200 OK
2026-02-09 16:09:01,555 - api_logger - INFO - rid=/api/portfolio/002050/news method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=14.52ms
INFO:     127.0.0.1:60215 - "GET /api/portfolio/002050/news HTTP/1.1" 200 OK
2026-02-09 16:09:01,556 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:09:01,556 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:09:01,556 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:09:01,556 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:09:01,922 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=321.22ms
INFO:     127.0.0.1:60215 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
 GET /?ticker=002050 200 in 38ms (compile: 4ms, render: 34ms)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:09:02,391 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:09:02,391 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:09:02,391 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:09:02,391 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:09:02,391 INFO sqlalchemy.engine.Engine [cached since 875.6s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:09:02,391 - sqlalchemy.engine.Engine - INFO - [cached since 875.6s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:09:02,392 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:09:02,392 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:09:02,392 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:09:02,392 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:09:02,392 INFO sqlalchemy.engine.Engine [cached since 875.6s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:09:02,392 - sqlalchemy.engine.Engine - INFO - [cached since 875.6s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:09:02,392 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:09:02,392 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:09:02,392 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:09:02,392 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:09:02,392 INFO sqlalchemy.engine.Engine [cached since 875.6s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:09:02,392 - sqlalchemy.engine.Engine - INFO - [cached since 875.6s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:09:02,393 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 16:09:02,393 - sqlalchemy.engine.Engine - INFO - SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 16:09:02,393 INFO sqlalchemy.engine.Engine [cached since 875.6s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:09:02,393 - sqlalchemy.engine.Engine - INFO - [cached since 875.6s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:09:02,393 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:09:02,393 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:09:02,393 INFO sqlalchemy.engine.Engine [cached since 745.4s ago] ('002050', 20, 0)
2026-02-09 16:09:02,393 - sqlalchemy.engine.Engine - INFO - [cached since 745.4s ago] ('002050', 20, 0)
2026-02-09 16:09:02,393 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:09:02,393 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:09:02,393 INFO sqlalchemy.engine.Engine [cached since 745.4s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 16:09:02,393 - sqlalchemy.engine.Engine - INFO - [cached since 745.4s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 16:09:02,400 - api_logger - INFO - rid=/api/portfolio/ method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=8.76ms
INFO:     127.0.0.1:60214 - "GET /api/portfolio/?refresh=false HTTP/1.1" 200 OK
2026-02-09 16:09:02,403 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:09:02,403 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:09:02,404 - api_logger - INFO - rid=/api/analysis/002050 method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=14.14ms
INFO:     127.0.0.1:60215 - "GET /api/analysis/002050 HTTP/1.1" 200 OK
2026-02-09 16:09:02,405 - api_logger - INFO - rid=/api/portfolio/002050/news method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=13.40ms
INFO:     127.0.0.1:60216 - "GET /api/portfolio/002050/news HTTP/1.1" 200 OK
2026-02-09 16:09:02,405 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:09:02,405 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:09:02,406 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:09:02,406 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:09:02,724 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=280.44ms
INFO:     127.0.0.1:60216 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
 GET /?ticker=002050 200 in 34ms (compile: 3ms, render: 31ms)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:09:03,213 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:09:03,213 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:09:03,214 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:09:03,214 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:09:03,214 INFO sqlalchemy.engine.Engine [cached since 876.4s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:09:03,214 - sqlalchemy.engine.Engine - INFO - [cached since 876.4s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:09:03,214 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:09:03,214 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:09:03,214 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:09:03,214 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:09:03,214 INFO sqlalchemy.engine.Engine [cached since 876.4s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:09:03,214 - sqlalchemy.engine.Engine - INFO - [cached since 876.4s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:09:03,214 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:09:03,214 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:09:03,214 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:09:03,214 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:09:03,214 INFO sqlalchemy.engine.Engine [cached since 876.4s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:09:03,214 - sqlalchemy.engine.Engine - INFO - [cached since 876.4s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:09:03,215 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:09:03,215 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:09:03,215 INFO sqlalchemy.engine.Engine [cached since 746.2s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 16:09:03,215 - sqlalchemy.engine.Engine - INFO - [cached since 746.2s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 16:09:03,215 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 16:09:03,215 - sqlalchemy.engine.Engine - INFO - SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 16:09:03,215 INFO sqlalchemy.engine.Engine [cached since 876.4s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:09:03,215 - sqlalchemy.engine.Engine - INFO - [cached since 876.4s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:09:03,216 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:09:03,216 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:09:03,216 INFO sqlalchemy.engine.Engine [cached since 746.2s ago] ('002050', 20, 0)
2026-02-09 16:09:03,216 - sqlalchemy.engine.Engine - INFO - [cached since 746.2s ago] ('002050', 20, 0)
2026-02-09 16:09:03,216 - api_logger - INFO - rid=/api/analysis/002050 method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=3.75ms
INFO:     127.0.0.1:60216 - "GET /api/analysis/002050 HTTP/1.1" 200 OK
2026-02-09 16:09:03,218 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:09:03,218 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:09:03,227 - api_logger - INFO - rid=/api/portfolio/002050/news method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=12.73ms
INFO:     127.0.0.1:60214 - "GET /api/portfolio/002050/news HTTP/1.1" 200 OK
2026-02-09 16:09:03,227 - api_logger - INFO - rid=/api/portfolio/ method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=13.08ms
INFO:     127.0.0.1:60215 - "GET /api/portfolio/?refresh=false HTTP/1.1" 200 OK
2026-02-09 16:09:03,228 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:09:03,228 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:09:03,228 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:09:03,228 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:09:03,565 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=286.67ms
INFO:     127.0.0.1:60215 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
âœ“ Compiled in 45ms
 GET /?ticker=002050 200 in 154ms (compile: 43ms, render: 110ms)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:11:53,477 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:11:53,477 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:11:53,485 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:11:53,485 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:11:53,486 INFO sqlalchemy.engine.Engine [cached since 1047s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:11:53,486 - sqlalchemy.engine.Engine - INFO - [cached since 1047s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:11:53,487 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:11:53,487 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:11:53,487 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:11:53,487 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:11:53,487 INFO sqlalchemy.engine.Engine [cached since 1047s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:11:53,487 - sqlalchemy.engine.Engine - INFO - [cached since 1047s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 16:11:53,487 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 16:11:53,487 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 16:11:53,487 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:11:53,487 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 16:11:53,487 INFO sqlalchemy.engine.Engine [cached since 1047s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:11:53,487 - sqlalchemy.engine.Engine - INFO - [cached since 1047s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:11:53,489 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:11:53,489 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 16:11:53,489 INFO sqlalchemy.engine.Engine [cached since 916.5s ago] ('002050', 20, 0)
2026-02-09 16:11:53,489 - sqlalchemy.engine.Engine - INFO - [cached since 916.5s ago] ('002050', 20, 0)
2026-02-09 16:11:53,489 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 16:11:53,489 - sqlalchemy.engine.Engine - INFO - SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 16:11:53,489 INFO sqlalchemy.engine.Engine [cached since 1047s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:11:53,489 - sqlalchemy.engine.Engine - INFO - [cached since 1047s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 16:11:53,489 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:11:53,489 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 16:11:53,489 INFO sqlalchemy.engine.Engine [cached since 916.5s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 16:11:53,489 - sqlalchemy.engine.Engine - INFO - [cached since 916.5s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 16:11:53,490 - api_logger - INFO - rid=/api/analysis/002050 method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=28.30ms
INFO:     127.0.0.1:60609 - "GET /api/analysis/002050 HTTP/1.1" 200 OK
2026-02-09 16:11:53,491 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:11:53,491 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:11:53,492 - api_logger - INFO - rid=/api/portfolio/002050/news method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=26.68ms
INFO:     127.0.0.1:60611 - "GET /api/portfolio/002050/news HTTP/1.1" 200 OK
2026-02-09 16:11:53,496 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:11:53,496 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:11:53,496 - api_logger - INFO - rid=/api/portfolio/ method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=31.23ms
INFO:     127.0.0.1:60610 - "GET /api/portfolio/?refresh=false HTTP/1.1" 200 OK
2026-02-09 16:11:53,496 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 16:11:53,496 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 16:11:53,928 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=372.23ms
INFO:     127.0.0.1:60610 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
âœ“ Compiled in 50ms
 GET /?ticker=002050 200 in 172ms (compile: 66ms, render: 106ms)
INFO:     127.0.0.1:55136 - "OPTIONS /api/analysis/002050 HTTP/1.1" 200 OK
INFO:     127.0.0.1:55138 - "OPTIONS /api/portfolio/?refresh=false HTTP/1.1" 200 OK
INFO:     127.0.0.1:55139 - "OPTIONS /api/portfolio/002050/news HTTP/1.1" 200 OK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710066, 'sub': '27f9c1a8-f876-4722-ac36-4f9fc0835ec3'}
2026-02-09 17:46:01,686 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 17:46:01,686 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 17:46:01,686 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 17:46:01,686 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 17:46:01,687 INFO sqlalchemy.engine.Engine [cached since 6695s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 17:46:01,687 - sqlalchemy.engine.Engine - INFO - [cached since 6695s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710066, 'sub': '27f9c1a8-f876-4722-ac36-4f9fc0835ec3'}
2026-02-09 17:46:01,687 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 17:46:01,687 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 17:46:01,688 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 17:46:01,688 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 17:46:01,688 INFO sqlalchemy.engine.Engine [cached since 6695s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 17:46:01,688 - sqlalchemy.engine.Engine - INFO - [cached since 6695s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710066, 'sub': '27f9c1a8-f876-4722-ac36-4f9fc0835ec3'}
2026-02-09 17:46:01,688 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 17:46:01,688 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 17:46:01,688 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 17:46:01,688 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 17:46:01,688 INFO sqlalchemy.engine.Engine [cached since 6695s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 17:46:01,688 - sqlalchemy.engine.Engine - INFO - [cached since 6695s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 17:46:01,693 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 17:46:01,693 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 17:46:01,693 INFO sqlalchemy.engine.Engine [cached since 6565s ago] ('002050', 20, 0)
2026-02-09 17:46:01,693 - sqlalchemy.engine.Engine - INFO - [cached since 6565s ago] ('002050', 20, 0)
2026-02-09 17:46:01,693 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 17:46:01,693 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 17:46:01,693 INFO sqlalchemy.engine.Engine [cached since 6565s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3', '002050', 'gemini-1.5-flash', 1, 0)
2026-02-09 17:46:01,693 - sqlalchemy.engine.Engine - INFO - [cached since 6565s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3', '002050', 'gemini-1.5-flash', 1, 0)
2026-02-09 17:46:01,694 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 17:46:01,694 - sqlalchemy.engine.Engine - INFO - SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 17:46:01,694 INFO sqlalchemy.engine.Engine [cached since 6695s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 17:46:01,694 - sqlalchemy.engine.Engine - INFO - [cached since 6695s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 17:46:01,696 - api_logger - INFO - rid=/api/portfolio/ method=GET status_code=200 user_id=27f9c1a8-f876-4722-ac36-4f9fc0835ec3 time=14.36ms
INFO:     127.0.0.1:55138 - "GET /api/portfolio/?refresh=false HTTP/1.1" 200 OK
2026-02-09 17:46:01,700 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 17:46:01,700 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 17:46:01,700 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 17:46:01,700 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 17:46:01,701 - api_logger - INFO - rid=/api/portfolio/002050/news method=GET status_code=200 user_id=27f9c1a8-f876-4722-ac36-4f9fc0835ec3 time=12.83ms
INFO:     127.0.0.1:55139 - "GET /api/portfolio/002050/news HTTP/1.1" 200 OK
2026-02-09 17:46:01,701 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 17:46:01,701 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 17:46:01,701 - api_logger - INFO - rid=/api/analysis/002050 method=GET status_code=404 user_id=27f9c1a8-f876-4722-ac36-4f9fc0835ec3 time=31.08ms
INFO:     127.0.0.1:55136 - "GET /api/analysis/002050 HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:55136 - "OPTIONS /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
2026-02-09 17:46:02,256 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=27f9c1a8-f876-4722-ac36-4f9fc0835ec3 time=510.31ms
INFO:     127.0.0.1:55136 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
 GET /sw.js 404 in 49ms (compile: 27ms, render: 22ms)
 GET /?ticker=002050 200 in 57ms (compile: 12ms, render: 44ms)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710066, 'sub': '27f9c1a8-f876-4722-ac36-4f9fc0835ec3'}
2026-02-09 17:46:56,222 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 17:46:56,222 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 17:46:56,223 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 17:46:56,223 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 17:46:56,224 INFO sqlalchemy.engine.Engine [cached since 6749s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 17:46:56,224 - sqlalchemy.engine.Engine - INFO - [cached since 6749s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710066, 'sub': '27f9c1a8-f876-4722-ac36-4f9fc0835ec3'}
2026-02-09 17:46:56,224 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 17:46:56,224 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 17:46:56,224 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 17:46:56,224 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 17:46:56,224 INFO sqlalchemy.engine.Engine [cached since 6749s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 17:46:56,224 - sqlalchemy.engine.Engine - INFO - [cached since 6749s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710066, 'sub': '27f9c1a8-f876-4722-ac36-4f9fc0835ec3'}
2026-02-09 17:46:56,224 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 17:46:56,224 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 17:46:56,225 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 17:46:56,225 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 17:46:56,225 INFO sqlalchemy.engine.Engine [cached since 6749s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 17:46:56,225 - sqlalchemy.engine.Engine - INFO - [cached since 6749s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 17:46:56,226 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 17:46:56,226 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 17:46:56,226 INFO sqlalchemy.engine.Engine [cached since 6619s ago] ('002050', 20, 0)
2026-02-09 17:46:56,226 - sqlalchemy.engine.Engine - INFO - [cached since 6619s ago] ('002050', 20, 0)
2026-02-09 17:46:56,226 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 17:46:56,226 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 17:46:56,227 INFO sqlalchemy.engine.Engine [cached since 6619s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3', '002050', 'gemini-1.5-flash', 1, 0)
2026-02-09 17:46:56,227 - sqlalchemy.engine.Engine - INFO - [cached since 6619s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3', '002050', 'gemini-1.5-flash', 1, 0)
2026-02-09 17:46:56,227 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 17:46:56,227 - sqlalchemy.engine.Engine - INFO - SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 17:46:56,227 INFO sqlalchemy.engine.Engine [cached since 6749s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 17:46:56,227 - sqlalchemy.engine.Engine - INFO - [cached since 6749s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 17:46:56,228 - api_logger - INFO - rid=/api/portfolio/002050/news method=GET status_code=200 user_id=27f9c1a8-f876-4722-ac36-4f9fc0835ec3 time=9.34ms
INFO:     127.0.0.1:55403 - "GET /api/portfolio/002050/news HTTP/1.1" 200 OK
2026-02-09 17:46:56,229 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 17:46:56,229 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 17:46:56,229 - api_logger - INFO - rid=/api/portfolio/ method=GET status_code=200 user_id=27f9c1a8-f876-4722-ac36-4f9fc0835ec3 time=10.89ms
INFO:     127.0.0.1:55402 - "GET /api/portfolio/?refresh=false HTTP/1.1" 200 OK
2026-02-09 17:46:56,229 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 17:46:56,229 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 17:46:56,230 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 17:46:56,230 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 17:46:56,230 - api_logger - INFO - rid=/api/analysis/002050 method=GET status_code=404 user_id=27f9c1a8-f876-4722-ac36-4f9fc0835ec3 time=12.88ms
INFO:     127.0.0.1:55401 - "GET /api/analysis/002050 HTTP/1.1" 404 Not Found
2026-02-09 17:46:56,619 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=27f9c1a8-f876-4722-ac36-4f9fc0835ec3 time=362.50ms
INFO:     127.0.0.1:55401 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
 GET /sw.js 404 in 37ms (compile: 7ms, render: 30ms)
 GET /?ticker=002050 200 in 54ms (compile: 13ms, render: 41ms)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710066, 'sub': '27f9c1a8-f876-4722-ac36-4f9fc0835ec3'}
2026-02-09 17:55:05,735 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 17:55:05,735 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 17:55:05,736 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 17:55:05,736 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 17:55:05,736 INFO sqlalchemy.engine.Engine [cached since 7239s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 17:55:05,736 - sqlalchemy.engine.Engine - INFO - [cached since 7239s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710066, 'sub': '27f9c1a8-f876-4722-ac36-4f9fc0835ec3'}
2026-02-09 17:55:05,737 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 17:55:05,737 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 17:55:05,737 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 17:55:05,737 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 17:55:05,737 INFO sqlalchemy.engine.Engine [cached since 7239s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 17:55:05,737 - sqlalchemy.engine.Engine - INFO - [cached since 7239s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710066, 'sub': '27f9c1a8-f876-4722-ac36-4f9fc0835ec3'}
2026-02-09 17:55:05,738 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 17:55:05,738 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 17:55:05,738 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 17:55:05,738 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 17:55:05,738 INFO sqlalchemy.engine.Engine [cached since 7239s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 17:55:05,738 - sqlalchemy.engine.Engine - INFO - [cached since 7239s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 17:55:05,739 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 17:55:05,739 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 17:55:05,740 INFO sqlalchemy.engine.Engine [cached since 7109s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3', '002050', 'gemini-1.5-flash', 1, 0)
2026-02-09 17:55:05,740 - sqlalchemy.engine.Engine - INFO - [cached since 7109s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3', '002050', 'gemini-1.5-flash', 1, 0)
2026-02-09 17:55:05,740 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 17:55:05,740 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 17:55:05,740 INFO sqlalchemy.engine.Engine [cached since 7109s ago] ('002050', 20, 0)
2026-02-09 17:55:05,740 - sqlalchemy.engine.Engine - INFO - [cached since 7109s ago] ('002050', 20, 0)
2026-02-09 17:55:05,740 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 17:55:05,740 - sqlalchemy.engine.Engine - INFO - SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 17:55:05,740 INFO sqlalchemy.engine.Engine [cached since 7239s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 17:55:05,740 - sqlalchemy.engine.Engine - INFO - [cached since 7239s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 17:55:05,741 - api_logger - INFO - rid=/api/portfolio/ method=GET status_code=200 user_id=27f9c1a8-f876-4722-ac36-4f9fc0835ec3 time=10.45ms
INFO:     127.0.0.1:56646 - "GET /api/portfolio/?refresh=false HTTP/1.1" 200 OK
2026-02-09 17:55:05,742 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 17:55:05,742 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 17:55:05,742 - api_logger - INFO - rid=/api/portfolio/002050/news method=GET status_code=200 user_id=27f9c1a8-f876-4722-ac36-4f9fc0835ec3 time=11.47ms
INFO:     127.0.0.1:56647 - "GET /api/portfolio/002050/news HTTP/1.1" 200 OK
2026-02-09 17:55:05,743 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 17:55:05,743 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 17:55:05,743 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 17:55:05,743 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 17:55:05,744 - api_logger - INFO - rid=/api/analysis/002050 method=GET status_code=404 user_id=27f9c1a8-f876-4722-ac36-4f9fc0835ec3 time=13.40ms
INFO:     127.0.0.1:56645 - "GET /api/analysis/002050 HTTP/1.1" 404 Not Found
2026-02-09 17:55:06,147 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=27f9c1a8-f876-4722-ac36-4f9fc0835ec3 time=377.90ms
INFO:     127.0.0.1:56645 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
 GET /sw.js 404 in 47ms (compile: 13ms, render: 34ms)
 GET / 200 in 119ms (compile: 8ms, render: 111ms)
âš  Cross origin request detected from 127.0.0.1 to /_next/* resource. In a future major version of Next.js, you will need to explicitly configure "allowedDevOrigins" in next.config to allow this.
Read more: https://nextjs.org/docs/app/api-reference/config/next-config-js/allowedDevOrigins
 GET /login 200 in 16ms (compile: 7ms, render: 10ms)
2026-02-09 17:57:47,468 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 17:57:47,468 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 17:57:47,471 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.email = ?
2026-02-09 17:57:47,471 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.email = ?
2026-02-09 17:57:47,471 INFO sqlalchemy.engine.Engine [cached since 7401s ago] ('test_new@example.com',)
2026-02-09 17:57:47,471 - sqlalchemy.engine.Engine - INFO - [cached since 7401s ago] ('test_new@example.com',)
2026-02-09 17:57:47,473 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 17:57:47,473 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 17:57:47,473 - api_logger - INFO - rid=/api/auth/login method=POST status_code=400 user_id=anonymous time=14.47ms
INFO:     127.0.0.1:56975 - "POST /api/auth/login HTTP/1.1" 400 Bad Request
 GET /register 200 in 23ms (compile: 9ms, render: 14ms)
INFO:     127.0.0.1:57009 - "OPTIONS /api/auth/register HTTP/1.1" 200 OK
2026-02-09 17:58:05,479 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 17:58:05,479 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 17:58:05,479 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.email = ?
2026-02-09 17:58:05,479 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.email = ?
2026-02-09 17:58:05,480 INFO sqlalchemy.engine.Engine [cached since 7419s ago] ('tester@example.com',)
2026-02-09 17:58:05,480 - sqlalchemy.engine.Engine - INFO - [cached since 7419s ago] ('tester@example.com',)
2026-02-09 17:58:05,725 INFO sqlalchemy.engine.Engine INSERT INTO users (id, email, hashed_password, is_active, membership_tier, api_key_gemini, api_key_deepseek, api_key_siliconflow, preferred_data_source, preferred_ai_model, created_at, last_login) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2026-02-09 17:58:05,725 - sqlalchemy.engine.Engine - INFO - INSERT INTO users (id, email, hashed_password, is_active, membership_tier, api_key_gemini, api_key_deepseek, api_key_siliconflow, preferred_data_source, preferred_ai_model, created_at, last_login) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
2026-02-09 17:58:05,725 INFO sqlalchemy.engine.Engine [cached since 7419s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099', 'tester@example.com', '$2b$12$x4Sfh2yh74ZDYkFO7Uw9rOSSn.5tJkWKd9MadLf0PyetG6HYu2oPa', 1, 'FREE', None, None, None, 'ALPHA_VANTAGE', 'gemini-1.5-flash', '2026-02-09 09:58:05.725035', None)
2026-02-09 17:58:05,725 - sqlalchemy.engine.Engine - INFO - [cached since 7419s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099', 'tester@example.com', '$2b$12$x4Sfh2yh74ZDYkFO7Uw9rOSSn.5tJkWKd9MadLf0PyetG6HYu2oPa', 1, 'FREE', None, None, None, 'ALPHA_VANTAGE', 'gemini-1.5-flash', '2026-02-09 09:58:05.725035', None)
2026-02-09 17:58:05,727 INFO sqlalchemy.engine.Engine COMMIT
2026-02-09 17:58:05,727 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-09 17:58:05,729 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 17:58:05,729 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 17:58:05,729 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 17:58:05,729 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 17:58:05,729 INFO sqlalchemy.engine.Engine [cached since 7419s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099',)
2026-02-09 17:58:05,729 - sqlalchemy.engine.Engine - INFO - [cached since 7419s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099',)
2026-02-09 17:58:05,730 - api_logger - INFO - rid=/api/auth/register method=POST status_code=200 user_id=anonymous time=255.09ms
INFO:     127.0.0.1:57009 - "POST /api/auth/register HTTP/1.1" 200 OK
2026-02-09 17:58:05,731 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 17:58:05,731 - sqlalchemy.engine.Engine - INFO - ROLLBACK
 GET / 200 in 14ms (compile: 5ms, render: 9ms)
INFO:     127.0.0.1:57009 - "OPTIONS /api/portfolio/?refresh=false HTTP/1.1" 200 OK
INFO:     127.0.0.1:57014 - "OPTIONS /api/portfolio/?refresh=false HTTP/1.1" 200 OK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770717485, 'sub': '92be8643-67f5-4a66-b27d-5aeafd157099'}
2026-02-09 17:58:05,777 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 17:58:05,777 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 17:58:05,777 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 17:58:05,777 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 17:58:05,778 INFO sqlalchemy.engine.Engine [cached since 7419s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099',)
2026-02-09 17:58:05,778 - sqlalchemy.engine.Engine - INFO - [cached since 7419s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099',)
2026-02-09 17:58:05,786 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 17:58:05,786 - sqlalchemy.engine.Engine - INFO - SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 17:58:05,786 INFO sqlalchemy.engine.Engine [cached since 7419s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099',)
2026-02-09 17:58:05,786 - sqlalchemy.engine.Engine - INFO - [cached since 7419s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099',)
2026-02-09 17:58:05,788 - api_logger - INFO - rid=/api/portfolio/ method=GET status_code=200 user_id=92be8643-67f5-4a66-b27d-5aeafd157099 time=11.77ms
INFO:     127.0.0.1:57009 - "GET /api/portfolio/?refresh=false HTTP/1.1" 200 OK
2026-02-09 17:58:05,789 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 17:58:05,789 - sqlalchemy.engine.Engine - INFO - ROLLBACK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770717485, 'sub': '92be8643-67f5-4a66-b27d-5aeafd157099'}
2026-02-09 17:58:05,792 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 17:58:05,792 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 17:58:05,793 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 17:58:05,793 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 17:58:05,793 INFO sqlalchemy.engine.Engine [cached since 7419s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099',)
2026-02-09 17:58:05,793 - sqlalchemy.engine.Engine - INFO - [cached since 7419s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099',)
2026-02-09 17:58:05,794 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 17:58:05,794 - sqlalchemy.engine.Engine - INFO - SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 17:58:05,795 INFO sqlalchemy.engine.Engine [cached since 7419s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099',)
2026-02-09 17:58:05,795 - sqlalchemy.engine.Engine - INFO - [cached since 7419s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099',)
2026-02-09 17:58:05,796 - api_logger - INFO - rid=/api/portfolio/ method=GET status_code=200 user_id=92be8643-67f5-4a66-b27d-5aeafd157099 time=5.77ms
INFO:     127.0.0.1:57009 - "GET /api/portfolio/?refresh=false HTTP/1.1" 200 OK
2026-02-09 17:58:05,798 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 17:58:05,798 - sqlalchemy.engine.Engine - INFO - ROLLBACK
INFO:     127.0.0.1:57015 - "OPTIONS /api/portfolio/search?query=A&remote=false HTTP/1.1" 200 OK
2026-02-09 17:58:27,453 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 17:58:27,453 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 17:58:27,453 INFO sqlalchemy.engine.Engine SELECT stocks.ticker, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM stocks 
WHERE lower(stocks.ticker) LIKE lower(?) OR lower(stocks.name) LIKE lower(?)
 LIMIT ? OFFSET ?
2026-02-09 17:58:27,453 - sqlalchemy.engine.Engine - INFO - SELECT stocks.ticker, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM stocks 
WHERE lower(stocks.ticker) LIKE lower(?) OR lower(stocks.name) LIKE lower(?)
 LIMIT ? OFFSET ?
2026-02-09 17:58:27,453 INFO sqlalchemy.engine.Engine [cached since 6754s ago] ('%A%', '%A%', 10, 0)
2026-02-09 17:58:27,453 - sqlalchemy.engine.Engine - INFO - [cached since 6754s ago] ('%A%', '%A%', 10, 0)
2026-02-09 17:58:27,455 - api_logger - INFO - rid=/api/portfolio/search method=GET status_code=200 user_id=92be8643-67f5-4a66-b27d-5aeafd157099 time=2.94ms
INFO:     127.0.0.1:57015 - "GET /api/portfolio/search?query=A&remote=false HTTP/1.1" 200 OK
2026-02-09 17:58:27,455 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 17:58:27,455 - sqlalchemy.engine.Engine - INFO - ROLLBACK
INFO:     127.0.0.1:57015 - "OPTIONS /api/portfolio/search?query=AA&remote=false HTTP/1.1" 200 OK
2026-02-09 17:58:27,458 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 17:58:27,458 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 17:58:27,458 INFO sqlalchemy.engine.Engine SELECT stocks.ticker, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM stocks 
WHERE lower(stocks.ticker) LIKE lower(?) OR lower(stocks.name) LIKE lower(?)
 LIMIT ? OFFSET ?
2026-02-09 17:58:27,458 - sqlalchemy.engine.Engine - INFO - SELECT stocks.ticker, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM stocks 
WHERE lower(stocks.ticker) LIKE lower(?) OR lower(stocks.name) LIKE lower(?)
 LIMIT ? OFFSET ?
2026-02-09 17:58:27,458 INFO sqlalchemy.engine.Engine [cached since 6754s ago] ('%AA%', '%AA%', 10, 0)
2026-02-09 17:58:27,458 - sqlalchemy.engine.Engine - INFO - [cached since 6754s ago] ('%AA%', '%AA%', 10, 0)
2026-02-09 17:58:27,458 - api_logger - INFO - rid=/api/portfolio/search method=GET status_code=200 user_id=92be8643-67f5-4a66-b27d-5aeafd157099 time=1.27ms
INFO:     127.0.0.1:57015 - "GET /api/portfolio/search?query=AA&remote=false HTTP/1.1" 200 OK
2026-02-09 17:58:27,459 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 17:58:27,459 - sqlalchemy.engine.Engine - INFO - ROLLBACK
INFO:     127.0.0.1:57015 - "OPTIONS /api/portfolio/search?query=AAP&remote=false HTTP/1.1" 200 OK
2026-02-09 17:58:27,468 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 17:58:27,468 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 17:58:27,468 INFO sqlalchemy.engine.Engine SELECT stocks.ticker, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM stocks 
WHERE lower(stocks.ticker) LIKE lower(?) OR lower(stocks.name) LIKE lower(?)
 LIMIT ? OFFSET ?
2026-02-09 17:58:27,468 - sqlalchemy.engine.Engine - INFO - SELECT stocks.ticker, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM stocks 
WHERE lower(stocks.ticker) LIKE lower(?) OR lower(stocks.name) LIKE lower(?)
 LIMIT ? OFFSET ?
2026-02-09 17:58:27,468 INFO sqlalchemy.engine.Engine [cached since 6754s ago] ('%AAP%', '%AAP%', 10, 0)
2026-02-09 17:58:27,468 - sqlalchemy.engine.Engine - INFO - [cached since 6754s ago] ('%AAP%', '%AAP%', 10, 0)
2026-02-09 17:58:27,470 - api_logger - INFO - rid=/api/portfolio/search method=GET status_code=200 user_id=92be8643-67f5-4a66-b27d-5aeafd157099 time=3.63ms
INFO:     127.0.0.1:57015 - "GET /api/portfolio/search?query=AAP&remote=false HTTP/1.1" 200 OK
2026-02-09 17:58:27,471 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 17:58:27,471 - sqlalchemy.engine.Engine - INFO - ROLLBACK
INFO:     127.0.0.1:57015 - "OPTIONS /api/portfolio/search?query=AAPL&remote=false HTTP/1.1" 200 OK
2026-02-09 17:58:27,473 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 17:58:27,473 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 17:58:27,473 INFO sqlalchemy.engine.Engine SELECT stocks.ticker, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM stocks 
WHERE lower(stocks.ticker) LIKE lower(?) OR lower(stocks.name) LIKE lower(?)
 LIMIT ? OFFSET ?
2026-02-09 17:58:27,473 - sqlalchemy.engine.Engine - INFO - SELECT stocks.ticker, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM stocks 
WHERE lower(stocks.ticker) LIKE lower(?) OR lower(stocks.name) LIKE lower(?)
 LIMIT ? OFFSET ?
2026-02-09 17:58:27,473 INFO sqlalchemy.engine.Engine [cached since 6754s ago] ('%AAPL%', '%AAPL%', 10, 0)
2026-02-09 17:58:27,473 - sqlalchemy.engine.Engine - INFO - [cached since 6754s ago] ('%AAPL%', '%AAPL%', 10, 0)
2026-02-09 17:58:27,474 - api_logger - INFO - rid=/api/portfolio/search method=GET status_code=200 user_id=92be8643-67f5-4a66-b27d-5aeafd157099 time=1.40ms
INFO:     127.0.0.1:57015 - "GET /api/portfolio/search?query=AAPL&remote=false HTTP/1.1" 200 OK
2026-02-09 17:58:27,474 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 17:58:27,474 - sqlalchemy.engine.Engine - INFO - ROLLBACK
INFO:     127.0.0.1:57015 - "OPTIONS /api/portfolio/search?query=AAPL&remote=true HTTP/1.1" 200 OK
2026-02-09 17:58:28,914 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 17:58:28,914 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 17:58:28,915 INFO sqlalchemy.engine.Engine SELECT stocks.ticker, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM stocks 
WHERE lower(stocks.ticker) LIKE lower(?) OR lower(stocks.name) LIKE lower(?)
 LIMIT ? OFFSET ?
2026-02-09 17:58:28,915 - sqlalchemy.engine.Engine - INFO - SELECT stocks.ticker, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM stocks 
WHERE lower(stocks.ticker) LIKE lower(?) OR lower(stocks.name) LIKE lower(?)
 LIMIT ? OFFSET ?
2026-02-09 17:58:28,915 INFO sqlalchemy.engine.Engine [cached since 6756s ago] ('%AAPL%', '%AAPL%', 10, 0)
2026-02-09 17:58:28,915 - sqlalchemy.engine.Engine - INFO - [cached since 6756s ago] ('%AAPL%', '%AAPL%', 10, 0)
2026-02-09 17:58:28,917 - api_logger - INFO - rid=/api/portfolio/search method=GET status_code=200 user_id=92be8643-67f5-4a66-b27d-5aeafd157099 time=4.11ms
INFO:     127.0.0.1:57015 - "GET /api/portfolio/search?query=AAPL&remote=true HTTP/1.1" 200 OK
2026-02-09 17:58:28,919 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 17:58:28,919 - sqlalchemy.engine.Engine - INFO - ROLLBACK
INFO:     127.0.0.1:57062 - "OPTIONS /api/portfolio/ HTTP/1.1" 200 OK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770717485, 'sub': '92be8643-67f5-4a66-b27d-5aeafd157099'}
2026-02-09 17:58:37,655 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 17:58:37,655 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 17:58:37,655 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 17:58:37,655 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 17:58:37,655 INFO sqlalchemy.engine.Engine [cached since 7451s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099',)
2026-02-09 17:58:37,655 - sqlalchemy.engine.Engine - INFO - [cached since 7451s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099',)
2026-02-09 17:58:37,656 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at 
FROM portfolios 
WHERE portfolios.user_id = ? AND portfolios.ticker = ?
2026-02-09 17:58:37,656 - sqlalchemy.engine.Engine - INFO - SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at 
FROM portfolios 
WHERE portfolios.user_id = ? AND portfolios.ticker = ?
2026-02-09 17:58:37,656 INFO sqlalchemy.engine.Engine [cached since 6757s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099', 'AAPL')
2026-02-09 17:58:37,656 - sqlalchemy.engine.Engine - INFO - [cached since 6757s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099', 'AAPL')
2026-02-09 17:58:37,657 INFO sqlalchemy.engine.Engine INSERT INTO portfolios (id, user_id, ticker, quantity, avg_cost, target_price, stop_loss_price, created_at, updated_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)
2026-02-09 17:58:37,657 - sqlalchemy.engine.Engine - INFO - INSERT INTO portfolios (id, user_id, ticker, quantity, avg_cost, target_price, stop_loss_price, created_at, updated_at) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)
2026-02-09 17:58:37,657 INFO sqlalchemy.engine.Engine [cached since 6757s ago] ('63294708-95f8-4c26-9273-af949e0a0afd', '92be8643-67f5-4a66-b27d-5aeafd157099', 'AAPL', 0.0, 0.0, None, None, '2026-02-09 09:58:37.657360', '2026-02-09 09:58:37.657364')
2026-02-09 17:58:37,657 - sqlalchemy.engine.Engine - INFO - [cached since 6757s ago] ('63294708-95f8-4c26-9273-af949e0a0afd', '92be8643-67f5-4a66-b27d-5aeafd157099', 'AAPL', 0.0, 0.0, None, None, '2026-02-09 09:58:37.657360', '2026-02-09 09:58:37.657364')
2026-02-09 17:58:37,658 INFO sqlalchemy.engine.Engine COMMIT
2026-02-09 17:58:37,658 - sqlalchemy.engine.Engine - INFO - COMMIT
2026-02-09 17:58:37,659 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 17:58:37,659 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 17:58:37,659 INFO sqlalchemy.engine.Engine SELECT market_data_cache.ticker, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated 
FROM market_data_cache 
WHERE market_data_cache.ticker = ?
2026-02-09 17:58:37,659 - sqlalchemy.engine.Engine - INFO - SELECT market_data_cache.ticker, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated 
FROM market_data_cache 
WHERE market_data_cache.ticker = ?
2026-02-09 17:58:37,659 INFO sqlalchemy.engine.Engine [cached since 6757s ago] ('AAPL',)
2026-02-09 17:58:37,659 - sqlalchemy.engine.Engine - INFO - [cached since 6757s ago] ('AAPL',)
2026-02-09 17:58:37,660 - api_logger - INFO - rid=/api/portfolio/ method=POST status_code=200 user_id=92be8643-67f5-4a66-b27d-5aeafd157099 time=5.38ms
INFO:     127.0.0.1:57062 - "POST /api/portfolio/ HTTP/1.1" 200 OK
2026-02-09 17:58:37,660 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 17:58:37,660 - sqlalchemy.engine.Engine - INFO - ROLLBACK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770717485, 'sub': '92be8643-67f5-4a66-b27d-5aeafd157099'}
2026-02-09 17:58:37,664 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 17:58:37,664 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 17:58:37,664 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 17:58:37,664 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 17:58:37,664 INFO sqlalchemy.engine.Engine [cached since 7451s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099',)
2026-02-09 17:58:37,664 - sqlalchemy.engine.Engine - INFO - [cached since 7451s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099',)
2026-02-09 17:58:37,664 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 17:58:37,664 - sqlalchemy.engine.Engine - INFO - SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 17:58:37,664 INFO sqlalchemy.engine.Engine [cached since 7451s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099',)
2026-02-09 17:58:37,664 - sqlalchemy.engine.Engine - INFO - [cached since 7451s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099',)
2026-02-09 17:58:37,665 - api_logger - INFO - rid=/api/portfolio/ method=GET status_code=200 user_id=92be8643-67f5-4a66-b27d-5aeafd157099 time=2.16ms
INFO:     127.0.0.1:57062 - "GET /api/portfolio/?refresh=false HTTP/1.1" 200 OK
2026-02-09 17:58:37,665 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 17:58:37,665 - sqlalchemy.engine.Engine - INFO - ROLLBACK
 GET /?ticker=AAPL 200 in 35ms (compile: 4ms, render: 31ms)
INFO:     127.0.0.1:57062 - "OPTIONS /api/stocks/AAPL/history?period=1y HTTP/1.1" 200 OK
INFO:     127.0.0.1:57064 - "OPTIONS /api/analysis/AAPL HTTP/1.1" 200 OK
INFO:     127.0.0.1:57065 - "OPTIONS /api/stocks/AAPL/history?period=1y HTTP/1.1" 200 OK
INFO:     127.0.0.1:57066 - "OPTIONS /api/portfolio/AAPL/news HTTP/1.1" 200 OK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770717485, 'sub': '92be8643-67f5-4a66-b27d-5aeafd157099'}
2026-02-09 17:58:37,756 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 17:58:37,756 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 17:58:37,757 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 17:58:37,757 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 17:58:37,757 INFO sqlalchemy.engine.Engine [cached since 7451s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099',)
2026-02-09 17:58:37,757 - sqlalchemy.engine.Engine - INFO - [cached since 7451s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770717485, 'sub': '92be8643-67f5-4a66-b27d-5aeafd157099'}
2026-02-09 17:58:37,758 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 17:58:37,758 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 17:58:37,759 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 17:58:37,759 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 17:58:37,760 INFO sqlalchemy.engine.Engine [cached since 7451s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099',)
2026-02-09 17:58:37,760 - sqlalchemy.engine.Engine - INFO - [cached since 7451s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099',)
2026-02-09 17:58:37,761 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 17:58:37,761 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 17:58:37,762 INFO sqlalchemy.engine.Engine [cached since 7321s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099', 'AAPL', 'gemini-1.5-flash', 1, 0)
2026-02-09 17:58:37,762 - sqlalchemy.engine.Engine - INFO - [cached since 7321s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099', 'AAPL', 'gemini-1.5-flash', 1, 0)
2026-02-09 17:58:37,764 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 17:58:37,764 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 17:58:37,764 INFO sqlalchemy.engine.Engine [cached since 7321s ago] ('AAPL', 20, 0)
2026-02-09 17:58:37,764 - sqlalchemy.engine.Engine - INFO - [cached since 7321s ago] ('AAPL', 20, 0)
2026-02-09 17:58:37,769 - api_logger - INFO - rid=/api/portfolio/AAPL/news method=GET status_code=200 user_id=92be8643-67f5-4a66-b27d-5aeafd157099 time=14.05ms
INFO:     127.0.0.1:57066 - "GET /api/portfolio/AAPL/news HTTP/1.1" 200 OK
2026-02-09 17:58:37,770 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 17:58:37,770 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 17:58:37,770 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 17:58:37,770 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 17:58:37,771 - api_logger - INFO - rid=/api/analysis/AAPL method=GET status_code=404 user_id=92be8643-67f5-4a66-b27d-5aeafd157099 time=15.20ms
INFO:     127.0.0.1:57067 - "GET /api/analysis/AAPL HTTP/1.1" 404 Not Found
2026-02-09 17:58:38,149 - api_logger - INFO - rid=/api/stocks/AAPL/history method=GET status_code=200 user_id=92be8643-67f5-4a66-b27d-5aeafd157099 time=405.01ms
INFO:     127.0.0.1:57062 - "GET /api/stocks/AAPL/history?period=1y HTTP/1.1" 200 OK
2026-02-09 17:58:38,528 - api_logger - INFO - rid=/api/stocks/AAPL/history method=GET status_code=200 user_id=92be8643-67f5-4a66-b27d-5aeafd157099 time=375.83ms
INFO:     127.0.0.1:57062 - "GET /api/stocks/AAPL/history?period=1y HTTP/1.1" 200 OK
 GET /api/file?path=frontend/components/features/StockDetail.tsx 404 in 91ms (compile: 22ms, render: 68ms)
âœ“ Compiled in 76ms
âœ“ Compiled in 160ms
INFO:     127.0.0.1:57918 - "OPTIONS /api/portfolio/?refresh=false HTTP/1.1" 200 OK
INFO:     127.0.0.1:57919 - "OPTIONS /api/analysis/002050 HTTP/1.1" 200 OK
INFO:     127.0.0.1:57920 - "OPTIONS /api/portfolio/002050/news HTTP/1.1" 200 OK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710066, 'sub': '27f9c1a8-f876-4722-ac36-4f9fc0835ec3'}
2026-02-09 18:06:02,190 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 18:06:02,190 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 18:06:02,192 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:06:02,192 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:06:02,192 INFO sqlalchemy.engine.Engine [cached since 7895s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 18:06:02,192 - sqlalchemy.engine.Engine - INFO - [cached since 7895s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710066, 'sub': '27f9c1a8-f876-4722-ac36-4f9fc0835ec3'}
2026-02-09 18:06:02,193 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 18:06:02,193 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 18:06:02,193 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:06:02,193 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:06:02,193 INFO sqlalchemy.engine.Engine [cached since 7895s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 18:06:02,193 - sqlalchemy.engine.Engine - INFO - [cached since 7895s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710066, 'sub': '27f9c1a8-f876-4722-ac36-4f9fc0835ec3'}
2026-02-09 18:06:02,194 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 18:06:02,194 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 18:06:02,194 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:06:02,194 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:06:02,194 INFO sqlalchemy.engine.Engine [cached since 7895s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 18:06:02,194 - sqlalchemy.engine.Engine - INFO - [cached since 7895s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
INFO:     127.0.0.1:57924 - "OPTIONS /api/portfolio/?refresh=false HTTP/1.1" 200 OK
INFO:     127.0.0.1:57925 - "OPTIONS /api/analysis/002050 HTTP/1.1" 200 OK
INFO:     127.0.0.1:57926 - "OPTIONS /api/portfolio/002050/news HTTP/1.1" 200 OK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770717485, 'sub': '92be8643-67f5-4a66-b27d-5aeafd157099'}
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770717485, 'sub': '92be8643-67f5-4a66-b27d-5aeafd157099'}
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770717485, 'sub': '92be8643-67f5-4a66-b27d-5aeafd157099'}
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 18:06:02,202 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 18:06:02,202 - sqlalchemy.engine.Engine - INFO - SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 18:06:02,202 INFO sqlalchemy.engine.Engine [cached since 7895s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 18:06:02,202 - sqlalchemy.engine.Engine - INFO - [cached since 7895s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 18:06:02,202 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 18:06:02,202 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 18:06:02,202 INFO sqlalchemy.engine.Engine [cached since 7765s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3', '002050', 'gemini-1.5-flash', 1, 0)
2026-02-09 18:06:02,202 - sqlalchemy.engine.Engine - INFO - [cached since 7765s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3', '002050', 'gemini-1.5-flash', 1, 0)
2026-02-09 18:06:02,202 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 18:06:02,202 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 18:06:02,203 INFO sqlalchemy.engine.Engine [cached since 7765s ago] ('002050', 20, 0)
2026-02-09 18:06:02,203 - sqlalchemy.engine.Engine - INFO - [cached since 7765s ago] ('002050', 20, 0)
2026-02-09 18:06:02,203 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 18:06:02,203 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 18:06:02,203 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:06:02,203 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:06:02,203 INFO sqlalchemy.engine.Engine [cached since 7895s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099',)
2026-02-09 18:06:02,203 - sqlalchemy.engine.Engine - INFO - [cached since 7895s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099',)
2026-02-09 18:06:02,203 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 18:06:02,203 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 18:06:02,203 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:06:02,203 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:06:02,203 INFO sqlalchemy.engine.Engine [cached since 7895s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099',)
2026-02-09 18:06:02,203 - sqlalchemy.engine.Engine - INFO - [cached since 7895s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099',)
2026-02-09 18:06:02,203 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 18:06:02,203 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 18:06:02,203 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:06:02,203 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:06:02,203 INFO sqlalchemy.engine.Engine [cached since 7895s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099',)
2026-02-09 18:06:02,203 - sqlalchemy.engine.Engine - INFO - [cached since 7895s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099',)
2026-02-09 18:06:02,203 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 18:06:02,203 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 18:06:02,203 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:06:02,203 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:06:02,203 INFO sqlalchemy.engine.Engine [cached since 7895s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:06:02,203 - sqlalchemy.engine.Engine - INFO - [cached since 7895s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:06:02,203 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 18:06:02,203 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 18:06:02,203 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:06:02,203 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:06:02,203 INFO sqlalchemy.engine.Engine [cached since 7895s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:06:02,203 - sqlalchemy.engine.Engine - INFO - [cached since 7895s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:06:02,203 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 18:06:02,203 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 18:06:02,204 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:06:02,204 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:06:02,204 INFO sqlalchemy.engine.Engine [cached since 7895s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:06:02,204 - sqlalchemy.engine.Engine - INFO - [cached since 7895s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:06:02,204 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 18:06:02,204 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 18:06:02,205 - api_logger - INFO - rid=/api/portfolio/ method=GET status_code=200 user_id=27f9c1a8-f876-4722-ac36-4f9fc0835ec3 time=40.38ms
INFO:     127.0.0.1:57918 - "GET /api/portfolio/?refresh=false HTTP/1.1" 200 OK
2026-02-09 18:06:02,205 - api_logger - INFO - rid=/api/portfolio/002050/news method=GET status_code=200 user_id=27f9c1a8-f876-4722-ac36-4f9fc0835ec3 time=36.40ms
INFO:     127.0.0.1:57920 - "GET /api/portfolio/002050/news HTTP/1.1" 200 OK
2026-02-09 18:06:02,206 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 18:06:02,206 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 18:06:02,206 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 18:06:02,206 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 18:06:02,207 - api_logger - INFO - rid=/api/analysis/002050 method=GET status_code=404 user_id=27f9c1a8-f876-4722-ac36-4f9fc0835ec3 time=38.67ms
INFO:     127.0.0.1:57919 - "GET /api/analysis/002050 HTTP/1.1" 404 Not Found
2026-02-09 18:06:02,207 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 18:06:02,207 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 18:06:02,207 INFO sqlalchemy.engine.Engine [cached since 7765s ago] ('002050', 20, 0)
2026-02-09 18:06:02,207 - sqlalchemy.engine.Engine - INFO - [cached since 7765s ago] ('002050', 20, 0)
2026-02-09 18:06:02,208 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 18:06:02,208 - sqlalchemy.engine.Engine - INFO - SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 18:06:02,208 INFO sqlalchemy.engine.Engine [cached since 7895s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:06:02,208 - sqlalchemy.engine.Engine - INFO - [cached since 7895s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:06:02,208 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 18:06:02,208 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 18:06:02,208 INFO sqlalchemy.engine.Engine [cached since 7765s ago] ('AAPL', 20, 0)
2026-02-09 18:06:02,208 - sqlalchemy.engine.Engine - INFO - [cached since 7765s ago] ('AAPL', 20, 0)
2026-02-09 18:06:02,208 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 18:06:02,208 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 18:06:02,208 INFO sqlalchemy.engine.Engine [cached since 7765s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099', 'AAPL', 'gemini-1.5-flash', 1, 0)
2026-02-09 18:06:02,208 - sqlalchemy.engine.Engine - INFO - [cached since 7765s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099', 'AAPL', 'gemini-1.5-flash', 1, 0)
2026-02-09 18:06:02,208 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 18:06:02,208 - sqlalchemy.engine.Engine - INFO - SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 18:06:02,208 INFO sqlalchemy.engine.Engine [cached since 7895s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099',)
2026-02-09 18:06:02,208 - sqlalchemy.engine.Engine - INFO - [cached since 7895s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099',)
INFO:     127.0.0.1:57920 - "OPTIONS /api/user/me HTTP/1.1" 200 OK
2026-02-09 18:06:02,209 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 18:06:02,209 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 18:06:02,209 INFO sqlalchemy.engine.Engine [cached since 7765s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 18:06:02,209 - sqlalchemy.engine.Engine - INFO - [cached since 7765s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710066, 'sub': '27f9c1a8-f876-4722-ac36-4f9fc0835ec3'}
2026-02-09 18:06:02,212 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 18:06:02,212 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 18:06:02,213 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:06:02,213 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:06:02,213 INFO sqlalchemy.engine.Engine [cached since 7895s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 18:06:02,213 - sqlalchemy.engine.Engine - INFO - [cached since 7895s ago] ('27f9c1a8-f876-4722-ac36-4f9fc0835ec3',)
2026-02-09 18:06:02,213 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 18:06:02,213 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 18:06:02,216 - api_logger - INFO - rid=/api/analysis/AAPL method=GET status_code=404 user_id=92be8643-67f5-4a66-b27d-5aeafd157099 time=21.06ms
INFO:     127.0.0.1:57922 - "GET /api/analysis/AAPL HTTP/1.1" 404 Not Found
2026-02-09 18:06:02,216 - api_logger - INFO - rid=/api/portfolio/002050/news method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=18.52ms
INFO:     127.0.0.1:57924 - "GET /api/portfolio/002050/news HTTP/1.1" 200 OK
2026-02-09 18:06:02,217 - api_logger - INFO - rid=/api/user/me method=GET status_code=200 user_id=27f9c1a8-f876-4722-ac36-4f9fc0835ec3 time=7.33ms
INFO:     127.0.0.1:57920 - "GET /api/user/me HTTP/1.1" 200 OK
2026-02-09 18:06:02,218 - api_logger - INFO - rid=/api/analysis/002050 method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=19.77ms
INFO:     127.0.0.1:57925 - "GET /api/analysis/002050 HTTP/1.1" 200 OK
2026-02-09 18:06:02,220 - api_logger - INFO - rid=/api/portfolio/ method=GET status_code=200 user_id=92be8643-67f5-4a66-b27d-5aeafd157099 time=25.69ms
INFO:     127.0.0.1:57921 - "GET /api/portfolio/?refresh=false HTTP/1.1" 200 OK
2026-02-09 18:06:02,221 - api_logger - INFO - rid=/api/portfolio/AAPL/news method=GET status_code=200 user_id=92be8643-67f5-4a66-b27d-5aeafd157099 time=25.87ms
INFO:     127.0.0.1:57923 - "GET /api/portfolio/AAPL/news HTTP/1.1" 200 OK
2026-02-09 18:06:02,221 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 18:06:02,221 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 18:06:02,221 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 18:06:02,221 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 18:06:02,222 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 18:06:02,222 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 18:06:02,225 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 18:06:02,225 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 18:06:02,225 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 18:06:02,225 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 18:06:02,225 - api_logger - INFO - rid=/api/portfolio/ method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=27.60ms
INFO:     127.0.0.1:57926 - "GET /api/portfolio/?refresh=false HTTP/1.1" 200 OK
INFO:     127.0.0.1:57923 - "OPTIONS /api/user/me HTTP/1.1" 200 OK
2026-02-09 18:06:02,228 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 18:06:02,228 - sqlalchemy.engine.Engine - INFO - ROLLBACK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770717485, 'sub': '92be8643-67f5-4a66-b27d-5aeafd157099'}
2026-02-09 18:06:02,230 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 18:06:02,230 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 18:06:02,230 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:06:02,230 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:06:02,230 INFO sqlalchemy.engine.Engine [cached since 7895s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099',)
2026-02-09 18:06:02,230 - sqlalchemy.engine.Engine - INFO - [cached since 7895s ago] ('92be8643-67f5-4a66-b27d-5aeafd157099',)
INFO:     127.0.0.1:57926 - "OPTIONS /api/user/me HTTP/1.1" 200 OK
INFO:     127.0.0.1:57920 - "OPTIONS /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770710196, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 18:06:02,239 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 18:06:02,239 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 18:06:02,241 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:06:02,241 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:06:02,241 INFO sqlalchemy.engine.Engine [cached since 7895s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:06:02,241 - sqlalchemy.engine.Engine - INFO - [cached since 7895s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:06:02,242 - api_logger - INFO - rid=/api/user/me method=GET status_code=200 user_id=92be8643-67f5-4a66-b27d-5aeafd157099 time=13.59ms
INFO:     127.0.0.1:57923 - "GET /api/user/me HTTP/1.1" 200 OK
2026-02-09 18:06:02,243 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 18:06:02,243 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 18:06:02,244 - api_logger - INFO - rid=/api/user/me method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=6.18ms
INFO:     127.0.0.1:57926 - "GET /api/user/me HTTP/1.1" 200 OK
2026-02-09 18:06:02,246 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 18:06:02,246 - sqlalchemy.engine.Engine - INFO - ROLLBACK
INFO:     127.0.0.1:57926 - "OPTIONS /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
2026-02-09 18:06:02,628 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=27f9c1a8-f876-4722-ac36-4f9fc0835ec3 time=394.42ms
INFO:     127.0.0.1:57920 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
2026-02-09 18:06:02,649 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=271.09ms
INFO:     127.0.0.1:57926 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
2026-02-09 18:06:02,662 - api_logger - INFO - rid=/api/stocks/AAPL/history method=GET status_code=200 user_id=92be8643-67f5-4a66-b27d-5aeafd157099 time=392.13ms
INFO:     127.0.0.1:57923 - "GET /api/stocks/AAPL/history?period=1y HTTP/1.1" 200 OK
 GET /login 200 in 28ms (compile: 12ms, render: 17ms)
2026-02-09 18:11:58,104 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 18:11:58,104 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 18:11:58,106 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.email = ?
2026-02-09 18:11:58,106 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.email = ?
2026-02-09 18:11:58,106 INFO sqlalchemy.engine.Engine [cached since 8252s ago] ('test@qq.com',)
2026-02-09 18:11:58,106 - sqlalchemy.engine.Engine - INFO - [cached since 8252s ago] ('test@qq.com',)
2026-02-09 18:11:58,305 - api_logger - INFO - rid=/api/auth/login method=POST status_code=200 user_id=anonymous time=206.50ms
INFO:     127.0.0.1:58573 - "POST /api/auth/login HTTP/1.1" 200 OK
2026-02-09 18:11:58,306 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 18:11:58,306 - sqlalchemy.engine.Engine - INFO - ROLLBACK
 GET / 200 in 63ms (compile: 48ms, render: 15ms)
INFO:     127.0.0.1:58573 - "OPTIONS /api/portfolio/?refresh=false HTTP/1.1" 200 OK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770718318, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 18:11:58,415 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 18:11:58,415 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 18:11:58,415 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:11:58,415 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:11:58,415 INFO sqlalchemy.engine.Engine [cached since 8252s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:11:58,415 - sqlalchemy.engine.Engine - INFO - [cached since 8252s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:11:58,417 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 18:11:58,417 - sqlalchemy.engine.Engine - INFO - SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 18:11:58,417 INFO sqlalchemy.engine.Engine [cached since 8252s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:11:58,417 - sqlalchemy.engine.Engine - INFO - [cached since 8252s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:11:58,421 - api_logger - INFO - rid=/api/portfolio/ method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=6.42ms
INFO:     127.0.0.1:58573 - "GET /api/portfolio/?refresh=false HTTP/1.1" 200 OK
2026-02-09 18:11:58,422 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 18:11:58,422 - sqlalchemy.engine.Engine - INFO - ROLLBACK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770718318, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 18:11:58,422 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 18:11:58,422 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 18:11:58,423 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:11:58,423 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:11:58,423 INFO sqlalchemy.engine.Engine [cached since 8252s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:11:58,423 - sqlalchemy.engine.Engine - INFO - [cached since 8252s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:11:58,424 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 18:11:58,424 - sqlalchemy.engine.Engine - INFO - SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 18:11:58,424 INFO sqlalchemy.engine.Engine [cached since 8252s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:11:58,424 - sqlalchemy.engine.Engine - INFO - [cached since 8252s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:11:58,426 - api_logger - INFO - rid=/api/portfolio/ method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=4.43ms
INFO:     127.0.0.1:58573 - "GET /api/portfolio/?refresh=false HTTP/1.1" 200 OK
2026-02-09 18:11:58,429 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 18:11:58,429 - sqlalchemy.engine.Engine - INFO - ROLLBACK
 GET /?ticker=002050 200 in 10ms (compile: 1962Âµs, render: 8ms)
INFO:     127.0.0.1:58573 - "OPTIONS /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
INFO:     127.0.0.1:58579 - "OPTIONS /api/analysis/002050 HTTP/1.1" 200 OK
INFO:     127.0.0.1:58580 - "OPTIONS /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
INFO:     127.0.0.1:58582 - "OPTIONS /api/portfolio/002050/news HTTP/1.1" 200 OK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770718318, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 18:11:58,493 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 18:11:58,493 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 18:11:58,494 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:11:58,494 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:11:58,496 INFO sqlalchemy.engine.Engine [cached since 8252s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:11:58,496 - sqlalchemy.engine.Engine - INFO - [cached since 8252s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770718318, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 18:11:58,500 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 18:11:58,500 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 18:11:58,500 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:11:58,500 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:11:58,500 INFO sqlalchemy.engine.Engine [cached since 8252s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:11:58,500 - sqlalchemy.engine.Engine - INFO - [cached since 8252s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770718318, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 18:11:58,502 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 18:11:58,502 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 18:11:58,503 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:11:58,503 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:11:58,503 INFO sqlalchemy.engine.Engine [cached since 8252s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:11:58,503 - sqlalchemy.engine.Engine - INFO - [cached since 8252s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:11:58,506 - api_logger - INFO - rid=/api/user/me method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=18.61ms
INFO:     127.0.0.1:58581 - "GET /api/user/me HTTP/1.1" 200 OK
2026-02-09 18:11:58,509 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 18:11:58,509 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 18:11:58,509 INFO sqlalchemy.engine.Engine [cached since 8122s ago] ('002050', 20, 0)
2026-02-09 18:11:58,509 - sqlalchemy.engine.Engine - INFO - [cached since 8122s ago] ('002050', 20, 0)
2026-02-09 18:11:58,513 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 18:11:58,513 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 18:11:58,514 INFO sqlalchemy.engine.Engine [cached since 8122s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 18:11:58,514 - sqlalchemy.engine.Engine - INFO - [cached since 8122s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 18:11:58,515 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 18:11:58,515 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 18:11:58,521 - api_logger - INFO - rid=/api/analysis/002050 method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=23.08ms
INFO:     127.0.0.1:58579 - "GET /api/analysis/002050 HTTP/1.1" 200 OK
2026-02-09 18:11:58,522 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 18:11:58,522 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 18:11:58,524 - api_logger - INFO - rid=/api/portfolio/002050/news method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=26.40ms
INFO:     127.0.0.1:58580 - "GET /api/portfolio/002050/news HTTP/1.1" 200 OK
2026-02-09 18:11:58,526 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 18:11:58,526 - sqlalchemy.engine.Engine - INFO - ROLLBACK
 GET /?ticker=002050 200 in 33ms (compile: 4ms, render: 29ms)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770718318, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 18:11:58,542 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 18:11:58,542 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 18:11:58,543 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:11:58,543 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:11:58,543 INFO sqlalchemy.engine.Engine [cached since 8252s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:11:58,543 - sqlalchemy.engine.Engine - INFO - [cached since 8252s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:11:58,544 - api_logger - INFO - rid=/api/user/me method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=3.19ms
INFO:     127.0.0.1:58580 - "GET /api/user/me HTTP/1.1" 200 OK
2026-02-09 18:11:58,545 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 18:11:58,545 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 18:11:58,885 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=403.07ms
INFO:     127.0.0.1:58573 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
2026-02-09 18:11:59,188 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=301.06ms
INFO:     127.0.0.1:58573 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
 GET /?ticker=002050 200 in 90ms (compile: 979Âµs, render: 89ms)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770718318, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 18:12:08,076 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 18:12:08,076 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 18:12:08,076 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:12:08,076 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:12:08,076 INFO sqlalchemy.engine.Engine [cached since 8261s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:12:08,076 - sqlalchemy.engine.Engine - INFO - [cached since 8261s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770718318, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 18:12:08,077 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 18:12:08,077 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 18:12:08,077 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:12:08,077 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:12:08,077 INFO sqlalchemy.engine.Engine [cached since 8261s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:12:08,077 - sqlalchemy.engine.Engine - INFO - [cached since 8261s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770718318, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 18:12:08,079 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 18:12:08,079 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 18:12:08,079 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:12:08,079 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:12:08,080 INFO sqlalchemy.engine.Engine [cached since 8261s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:12:08,080 - sqlalchemy.engine.Engine - INFO - [cached since 8261s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:12:08,082 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 18:12:08,082 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 18:12:08,082 INFO sqlalchemy.engine.Engine [cached since 8131s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 18:12:08,082 - sqlalchemy.engine.Engine - INFO - [cached since 8131s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 18:12:08,083 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 18:12:08,083 - sqlalchemy.engine.Engine - INFO - SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 18:12:08,083 INFO sqlalchemy.engine.Engine [cached since 8261s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:12:08,083 - sqlalchemy.engine.Engine - INFO - [cached since 8261s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:12:08,083 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 18:12:08,083 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 18:12:08,083 INFO sqlalchemy.engine.Engine [cached since 8131s ago] ('002050', 20, 0)
2026-02-09 18:12:08,083 - sqlalchemy.engine.Engine - INFO - [cached since 8131s ago] ('002050', 20, 0)
2026-02-09 18:12:08,084 - api_logger - INFO - rid=/api/analysis/002050 method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=8.61ms
INFO:     127.0.0.1:58639 - "GET /api/analysis/002050 HTTP/1.1" 200 OK
2026-02-09 18:12:08,084 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 18:12:08,084 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 18:12:08,086 - api_logger - INFO - rid=/api/portfolio/002050/news method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=8.40ms
INFO:     127.0.0.1:58641 - "GET /api/portfolio/002050/news HTTP/1.1" 200 OK
2026-02-09 18:12:08,087 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 18:12:08,087 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 18:12:08,087 - api_logger - INFO - rid=/api/portfolio/ method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=11.63ms
INFO:     127.0.0.1:58640 - "GET /api/portfolio/?refresh=false HTTP/1.1" 200 OK
2026-02-09 18:12:08,087 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 18:12:08,087 - sqlalchemy.engine.Engine - INFO - ROLLBACK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770718318, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 18:12:08,090 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 18:12:08,090 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 18:12:08,090 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:12:08,090 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:12:08,090 INFO sqlalchemy.engine.Engine [cached since 8261s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:12:08,090 - sqlalchemy.engine.Engine - INFO - [cached since 8261s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:12:08,090 - api_logger - INFO - rid=/api/user/me method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=0.97ms
INFO:     127.0.0.1:58640 - "GET /api/user/me HTTP/1.1" 200 OK
2026-02-09 18:12:08,091 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 18:12:08,091 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 18:12:08,359 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=211.30ms
INFO:     127.0.0.1:58640 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
âœ“ Compiled in 116ms
 GET /?ticker=002050 200 in 173ms (compile: 49ms, render: 123ms)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770718318, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 18:13:42,288 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 18:13:42,288 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 18:13:42,289 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:13:42,289 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:13:42,289 INFO sqlalchemy.engine.Engine [cached since 8355s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:13:42,289 - sqlalchemy.engine.Engine - INFO - [cached since 8355s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770718318, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 18:13:42,290 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 18:13:42,290 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 18:13:42,290 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:13:42,290 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:13:42,290 INFO sqlalchemy.engine.Engine [cached since 8355s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:13:42,290 - sqlalchemy.engine.Engine - INFO - [cached since 8355s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770718318, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 18:13:42,290 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 18:13:42,290 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 18:13:42,290 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:13:42,290 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:13:42,290 INFO sqlalchemy.engine.Engine [cached since 8355s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:13:42,290 - sqlalchemy.engine.Engine - INFO - [cached since 8355s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:13:42,292 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 18:13:42,292 - sqlalchemy.engine.Engine - INFO - SELECT portfolios.id, portfolios.user_id, portfolios.ticker, portfolios.quantity, portfolios.avg_cost, portfolios.target_price, portfolios.stop_loss_price, portfolios.created_at, portfolios.updated_at, market_data_cache.ticker AS ticker_1, market_data_cache.current_price, market_data_cache.change_percent, market_data_cache.rsi_14, market_data_cache.ma_20, market_data_cache.ma_50, market_data_cache.ma_200, market_data_cache.macd_val, market_data_cache.macd_signal, market_data_cache.macd_hist, market_data_cache.macd_hist_slope, market_data_cache.bb_upper, market_data_cache.bb_middle, market_data_cache.bb_lower, market_data_cache.atr_14, market_data_cache.k_line, market_data_cache.d_line, market_data_cache.j_line, market_data_cache.volume_ma_20, market_data_cache.volume_ratio, market_data_cache.adx_14, market_data_cache.pivot_point, market_data_cache.resistance_1, market_data_cache.resistance_2, market_data_cache.support_1, market_data_cache.support_2, market_data_cache.market_status, market_data_cache.last_updated, stocks.ticker AS ticker_2, stocks.name, stocks.sector, stocks.industry, stocks.market_cap, stocks.pe_ratio, stocks.forward_pe, stocks.eps, stocks.dividend_yield, stocks.beta, stocks.fifty_two_week_high, stocks.fifty_two_week_low, stocks.exchange, stocks.currency 
FROM portfolios LEFT OUTER JOIN market_data_cache ON portfolios.ticker = market_data_cache.ticker LEFT OUTER JOIN stocks ON portfolios.ticker = stocks.ticker 
WHERE portfolios.user_id = ?
2026-02-09 18:13:42,292 INFO sqlalchemy.engine.Engine [cached since 8355s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:13:42,292 - sqlalchemy.engine.Engine - INFO - [cached since 8355s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:13:42,292 INFO sqlalchemy.engine.Engine SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 18:13:42,292 - sqlalchemy.engine.Engine - INFO - SELECT analysis_reports.id, analysis_reports.user_id, analysis_reports.ticker, analysis_reports.input_context_snapshot, analysis_reports.ai_response_markdown, analysis_reports.sentiment_score, analysis_reports.summary_status, analysis_reports.risk_level, analysis_reports.technical_analysis, analysis_reports.fundamental_news, analysis_reports.action_advice, analysis_reports.investment_horizon, analysis_reports.confidence_level, analysis_reports.immediate_action, analysis_reports.target_price, analysis_reports.stop_loss_price, analysis_reports.entry_zone, analysis_reports.entry_price_low, analysis_reports.entry_price_high, analysis_reports.rr_ratio, analysis_reports.model_used, analysis_reports.created_at 
FROM analysis_reports 
WHERE analysis_reports.user_id = ? AND analysis_reports.ticker = ? AND analysis_reports.model_used = ? ORDER BY analysis_reports.created_at DESC
 LIMIT ? OFFSET ?
2026-02-09 18:13:42,292 INFO sqlalchemy.engine.Engine [cached since 8225s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 18:13:42,292 - sqlalchemy.engine.Engine - INFO - [cached since 8225s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a', '002050', 'qwen-3-vl-thinking', 1, 0)
2026-02-09 18:13:42,293 INFO sqlalchemy.engine.Engine SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 18:13:42,293 - sqlalchemy.engine.Engine - INFO - SELECT stock_news.id, stock_news.ticker, stock_news.title, stock_news.publisher, stock_news.link, stock_news.publish_time, stock_news.summary, stock_news.sentiment 
FROM stock_news 
WHERE stock_news.ticker = ? ORDER BY stock_news.publish_time DESC
 LIMIT ? OFFSET ?
2026-02-09 18:13:42,293 INFO sqlalchemy.engine.Engine [cached since 8225s ago] ('002050', 20, 0)
2026-02-09 18:13:42,293 - sqlalchemy.engine.Engine - INFO - [cached since 8225s ago] ('002050', 20, 0)
2026-02-09 18:13:42,294 - api_logger - INFO - rid=/api/analysis/002050 method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=8.90ms
INFO:     127.0.0.1:58769 - "GET /api/analysis/002050 HTTP/1.1" 200 OK
2026-02-09 18:13:42,297 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 18:13:42,297 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 18:13:42,297 - api_logger - INFO - rid=/api/portfolio/ method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=10.86ms
INFO:     127.0.0.1:58770 - "GET /api/portfolio/?refresh=false HTTP/1.1" 200 OK
2026-02-09 18:13:42,297 - api_logger - INFO - rid=/api/portfolio/002050/news method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=11.53ms
INFO:     127.0.0.1:58771 - "GET /api/portfolio/002050/news HTTP/1.1" 200 OK
2026-02-09 18:13:42,298 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 18:13:42,298 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 18:13:42,298 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 18:13:42,298 - sqlalchemy.engine.Engine - INFO - ROLLBACK
DEBUG: Validating token: eyJhbGciOi...
DEBUG: Token payload: {'exp': 1770718318, 'sub': '9fe069c3-5985-4d2a-8814-91898152fc4a'}
2026-02-09 18:13:42,299 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2026-02-09 18:13:42,299 - sqlalchemy.engine.Engine - INFO - BEGIN (implicit)
2026-02-09 18:13:42,299 INFO sqlalchemy.engine.Engine SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:13:42,299 - sqlalchemy.engine.Engine - INFO - SELECT users.id, users.email, users.hashed_password, users.is_active, users.membership_tier, users.api_key_gemini, users.api_key_deepseek, users.api_key_siliconflow, users.preferred_data_source, users.preferred_ai_model, users.created_at, users.last_login 
FROM users 
WHERE users.id = ?
2026-02-09 18:13:42,299 INFO sqlalchemy.engine.Engine [cached since 8356s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:13:42,299 - sqlalchemy.engine.Engine - INFO - [cached since 8356s ago] ('9fe069c3-5985-4d2a-8814-91898152fc4a',)
2026-02-09 18:13:42,299 - api_logger - INFO - rid=/api/user/me method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=0.94ms
INFO:     127.0.0.1:58771 - "GET /api/user/me HTTP/1.1" 200 OK
2026-02-09 18:13:42,300 INFO sqlalchemy.engine.Engine ROLLBACK
2026-02-09 18:13:42,300 - sqlalchemy.engine.Engine - INFO - ROLLBACK
2026-02-09 18:13:42,620 - api_logger - INFO - rid=/api/stocks/002050/history method=GET status_code=200 user_id=9fe069c3-5985-4d2a-8814-91898152fc4a time=277.40ms
INFO:     127.0.0.1:58771 - "GET /api/stocks/002050/history?period=1y HTTP/1.1" 200 OK
âœ“ Compiled in 34ms
âœ“ Compiled in 113ms
